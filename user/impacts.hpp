 /* Copyright (C) 2017 Emmanouil Tzorakoleftherakis
    This program is free software: you can redistribute it and/or modify
    it under the terms of the GNU General Public License as published by
    the Free Software Foundation, either version 3 of the License, or
    (at your option) any later version.
    This program is distributed in the hope that it will be useful,
    but WITHOUT ANY WARRANTY; without even the implied warranty of
    MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the
    GNU General Public License for more details.
    You should have received a copy of the GNU General Public License
    along with this program.  If not, see <http://www.gnu.org/licenses/>.
 */

#ifndef IMPACTS_HPP
#define IMPACTS_HPP

namespace sac {

  //Class that uses the impact surface to calculate impact equations
  //Impact equations, adjoint reset map need to be specified by user
  class impacts {
	static double taf, tbef, tb, t_m;
	static int len, indx_;
	static state_type xtemp, x_imp;
	static Eigen::Matrix< double, xlen, xlen > PI_map;
	static Eigen::Matrix< double, xlen, 1 > mrho_;
  public:
  	static state_type ximp;//store impact point
	static state_type uim;//, u_imp_plus;//for control value used in adjoint reset
	static double tm;//stores impact time
	static state_type imp_times;//used in reset map of adjoint
	static std::vector<state_type> xim_m, xim_p;//states before/after impact (used in reset map of adjoint)

	
	/*Impact condition*/
	static bool condition(const state_type &x, const state_type &xprev) {
        return imp_condition(x, xprev);
    }
	
	/* Function that sets constant parts of PI reset map*/
	static void set_PI_map ( ){
		/*PI_map(0,0) = -1;
		PI_map(1,1) = -1; */ 
	}	
  
  /* Function that applies reset map for adjoint simulation*/
	static void PI_reset (double &time, int &i, state_type &rho, b_control &u);	
	
    /* Function that solves impacts*/
	static void Omega (state_type &x_af, state_type x_bef);	
	
  /* Function that calculates impact point x_imp with simulations*/
	static void calc_imp_point (sys_dynam& xdot, std::vector<state_type> &x_vec, state_type &times);	
  };
  
    double impacts::taf, impacts::tbef, impacts::t_m, impacts::tb;
    int impacts::len, impacts::indx_;
    state_type impacts::xtemp, impacts::x_imp;
	Eigen::Matrix< double, xlen, xlen > impacts::PI_map = Eigen::Matrix< double, xlen, xlen >::Zero();
	Eigen::Matrix< double, xlen, 1 > impacts::mrho_;
    state_type impacts::uim(ulen);// impacts::u_imp_plus(ulen);
    state_type impacts::imp_times;//used in reset map of adjoint
    std::vector<state_type> impacts::xim_m, impacts::xim_p;
    state_type impacts::ximp;//store impact point
    double impacts::tm = t_final;//stores impact time
  
  /* Function that solves impacts*/
	inline void impacts::Omega (state_type &x_af, state_type x_bef){
		//x_af[1]=-x_bef[1];
	  x_af[0] = x_bef[0];
	  x_af[1] = x_bef[1];
	  x_af[2] = x_bef[2];
	  x_af[3] = x_bef[3];
	  x_af[4] = x_bef[4];
	  x_af[5] = (cos(x_bef[0]+x_bef[1]*2.0)*x_bef[8]*-1.2E1+cos(x_bef[0]-x_bef[2]*2.0)*x_bef[8]-sin(x_bef[0]+x_bef[1]*2.0)*x_bef[9]*1.2E1+sin(x_bef[0]-x_bef[2]*2.0)*x_bef[9]-cos(x_bef[0]-x_bef[1]*2.0-x_bef[2]*2.0)*x_bef[8]+sin(x_bef[0]-x_bef[1]*2.0-x_bef[2]*2.0)*x_bef[9]+cos(x_bef[0]*2.0+x_bef[1]*2.0)*x_bef[5]+cos(x_bef[1]*2.0+x_bef[2]*2.0)*x_bef[5]*2.0+cos(x_bef[0])*x_bef[8]*1.2E1-sin(x_bef[0])*x_bef[9]*1.2E1-x_bef[5]*2.3E1)/(cos(x_bef[0]*2.0+x_bef[1]*2.0)+cos(x_bef[1]*2.0+x_bef[2]*2.0)*2.0-2.3E1);
	  x_af[6] = (-cos(x_bef[0]*2.0+x_bef[1])*x_bef[8]-cos(x_bef[1]+x_bef[2]*2.0)*x_bef[8]*2.0+sin(x_bef[0]*2.0+x_bef[1])*x_bef[9]+sin(x_bef[1]+x_bef[2]*2.0)*x_bef[9]*2.0+cos(x_bef[1])*x_bef[8]*2.3E1+sin(x_bef[1])*x_bef[9]*2.3E1)/(cos(x_bef[0]*2.0+x_bef[1]*2.0)+cos(x_bef[1]*2.0+x_bef[2]*2.0)*2.0-2.3E1);
	  x_af[7] = (cos(x_bef[1]*2.0+x_bef[2])*x_bef[8]*2.5E1+sin(x_bef[1]*2.0+x_bef[2])*x_bef[9]*2.5E1+cos(x_bef[0]*2.0+x_bef[1]*2.0)*x_bef[7]*2.0-cos(x_bef[0]*2.0-x_bef[2])*x_bef[8]+cos(x_bef[1]*2.0+x_bef[2]*2.0)*x_bef[7]*4.0-cos(x_bef[2])*x_bef[8]*2.5E1+sin(x_bef[0]*2.0-x_bef[2])*x_bef[9]+sin(x_bef[2])*x_bef[9]*2.5E1+cos(x_bef[0]*2.0+x_bef[1]*2.0-x_bef[2])*x_bef[8]+sin(x_bef[0]*2.0+x_bef[1]*2.0-x_bef[2])*x_bef[9]-x_bef[7]*4.6E1)/(cos(x_bef[0]*2.0+x_bef[1]*2.0)*2.0+cos(x_bef[1]*2.0+x_bef[2]*2.0)*4.0-4.6E1);
	  x_af[8] = -(-cos(x_bef[0]*2.0+x_bef[1]*2.0)*x_bef[8]-cos(x_bef[1]*2.0+x_bef[2]*2.0)*x_bef[8]*2.0+sin(x_bef[0]*2.0+x_bef[1]*2.0)*x_bef[9]+sin(x_bef[1]*2.0+x_bef[2]*2.0)*x_bef[9]*2.0-cos(x_bef[0]*2.0)*x_bef[8]+cos(x_bef[1]*2.0)*x_bef[8]*2.3E1-cos(x_bef[2]*2.0)*x_bef[8]*2.0+x_bef[8]*2.3E1+sin(x_bef[0]*2.0)*x_bef[9]+sin(x_bef[1]*2.0)*x_bef[9]*2.3E1+sin(x_bef[2]*2.0)*x_bef[9]*2.0)/(cos(x_bef[0]*2.0+x_bef[1]*2.0)*2.0+cos(x_bef[1]*2.0+x_bef[2]*2.0)*4.0-4.6E1);
	  x_af[9] = -(-cos(x_bef[0]*2.0+x_bef[1]*2.0)*x_bef[9]-cos(x_bef[1]*2.0+x_bef[2]*2.0)*x_bef[9]*2.0-sin(x_bef[0]*2.0+x_bef[1]*2.0)*x_bef[8]-sin(x_bef[1]*2.0+x_bef[2]*2.0)*x_bef[8]*2.0+cos(x_bef[0]*2.0)*x_bef[9]-cos(x_bef[1]*2.0)*x_bef[9]*2.3E1+cos(x_bef[2]*2.0)*x_bef[9]*2.0+x_bef[9]*2.3E1+sin(x_bef[0]*2.0)*x_bef[8]+sin(x_bef[1]*2.0)*x_bef[8]*2.3E1+sin(x_bef[2]*2.0)*x_bef[8]*2.0)/(cos(x_bef[0]*2.0+x_bef[1]*2.0)*2.0+cos(x_bef[1]*2.0+x_bef[2]*2.0)*4.0-4.6E1);

	  //Relabel coordinates (swap angles/angular velocities)
	  double temp = x_af[1]; x_af[1] = -x_af[0]; x_af[0] = -temp;
	  temp = x_af[6]; x_af[6] = -x_af[5]; x_af[5] = -temp;
	}
  
  
  /* Function that applies reset map for adjoint simulation*/
	inline void impacts::PI_reset (double &time, int &i, state_type &rho, b_control &u){
		u(time, xim_m[i], uim);//calculate uminus before impact
		time = time - impact_duration;//create reset time plus (time goes backwards)
		//u(time, xim_p[i], u_imp_plus);//calculate uplus after impact
		
		//update rho plus using reset map
	  PI_map(0,0) = 1.0;
	  PI_map(0,1) = (sin(xim_m[i][1])*xim_m[i][5])/(sin(xim_m[i][0])*xim_m[i][5]-sin(xim_m[i][1])*xim_m[i][6])-(sin(xim_m[i][1])*(cos(xim_m[i][0]+xim_m[i][1]*2.0)*xim_m[i][8]*-1.2E1+cos(xim_m[i][0]-xim_m[i][2]*2.0)*xim_m[i][8]-sin(xim_m[i][0]+xim_m[i][1]*2.0)*xim_m[i][9]*1.2E1+sin(xim_m[i][0]-xim_m[i][2]*2.0)*xim_m[i][9]+cos(xim_m[i][0])*xim_m[i][8]*1.2E1-sin(xim_m[i][0])*xim_m[i][9]*1.2E1-cos(xim_m[i][0]-xim_m[i][1]*2.0-xim_m[i][2]*2.0)*xim_m[i][8]+cos(xim_m[i][0]*2.0+xim_m[i][1]*2.0)*xim_m[i][5]+cos(xim_m[i][1]*2.0+xim_m[i][2]*2.0)*xim_m[i][5]*2.0+sin(xim_m[i][0]-xim_m[i][1]*2.0-xim_m[i][2]*2.0)*xim_m[i][9]-xim_m[i][5]*2.3E1))/((sin(xim_m[i][0])*xim_m[i][5]-sin(xim_m[i][1])*xim_m[i][6])*(cos(xim_m[i][0]*2.0+xim_m[i][1]*2.0)+cos(xim_m[i][1]*2.0+xim_m[i][2]*2.0)*2.0-2.3E1));
	  PI_map(0,4) = xim_m[i][5]/(sin(xim_m[i][0])*xim_m[i][5]-sin(xim_m[i][1])*xim_m[i][6])-(cos(xim_m[i][0]+xim_m[i][1]*2.0)*xim_m[i][8]*-1.2E1+cos(xim_m[i][0]-xim_m[i][2]*2.0)*xim_m[i][8]-sin(xim_m[i][0]+xim_m[i][1]*2.0)*xim_m[i][9]*1.2E1+sin(xim_m[i][0]-xim_m[i][2]*2.0)*xim_m[i][9]+cos(xim_m[i][0])*xim_m[i][8]*1.2E1-sin(xim_m[i][0])*xim_m[i][9]*1.2E1-cos(xim_m[i][0]-xim_m[i][1]*2.0-xim_m[i][2]*2.0)*xim_m[i][8]+cos(xim_m[i][0]*2.0+xim_m[i][1]*2.0)*xim_m[i][5]+cos(xim_m[i][1]*2.0+xim_m[i][2]*2.0)*xim_m[i][5]*2.0+sin(xim_m[i][0]-xim_m[i][1]*2.0-xim_m[i][2]*2.0)*xim_m[i][9]-xim_m[i][5]*2.3E1)/((sin(xim_m[i][0])*xim_m[i][5]-sin(xim_m[i][1])*xim_m[i][6])*(cos(xim_m[i][0]*2.0+xim_m[i][1]*2.0)+cos(xim_m[i][1]*2.0+xim_m[i][2]*2.0)*2.0-2.3E1));
	  PI_map(1,1) = (sin(xim_m[i][1])*xim_m[i][6])/(sin(xim_m[i][0])*xim_m[i][5]-sin(xim_m[i][1])*xim_m[i][6])-(sin(xim_m[i][1])*(-cos(xim_m[i][0]*2.0+xim_m[i][1])*xim_m[i][8]-cos(xim_m[i][1]+xim_m[i][2]*2.0)*xim_m[i][8]*2.0+sin(xim_m[i][0]*2.0+xim_m[i][1])*xim_m[i][9]+sin(xim_m[i][1]+xim_m[i][2]*2.0)*xim_m[i][9]*2.0+cos(xim_m[i][1])*xim_m[i][8]*2.3E1+sin(xim_m[i][1])*xim_m[i][9]*2.3E1))/((sin(xim_m[i][0])*xim_m[i][5]-sin(xim_m[i][1])*xim_m[i][6])*(cos(xim_m[i][0]*2.0+xim_m[i][1]*2.0)+cos(xim_m[i][1]*2.0+xim_m[i][2]*2.0)*2.0-2.3E1))+1.0;
	  PI_map(1,4) = xim_m[i][6]/(sin(xim_m[i][0])*xim_m[i][5]-sin(xim_m[i][1])*xim_m[i][6])-(-cos(xim_m[i][0]*2.0+xim_m[i][1])*xim_m[i][8]-cos(xim_m[i][1]+xim_m[i][2]*2.0)*xim_m[i][8]*2.0+sin(xim_m[i][0]*2.0+xim_m[i][1])*xim_m[i][9]+sin(xim_m[i][1]+xim_m[i][2]*2.0)*xim_m[i][9]*2.0+cos(xim_m[i][1])*xim_m[i][8]*2.3E1+sin(xim_m[i][1])*xim_m[i][9]*2.3E1)/((sin(xim_m[i][0])*xim_m[i][5]-sin(xim_m[i][1])*xim_m[i][6])*(cos(xim_m[i][0]*2.0+xim_m[i][1]*2.0)+cos(xim_m[i][1]*2.0+xim_m[i][2]*2.0)*2.0-2.3E1));
	  PI_map(2,1) = (sin(xim_m[i][1])*xim_m[i][7])/(sin(xim_m[i][0])*xim_m[i][5]-sin(xim_m[i][1])*xim_m[i][6])-(sin(xim_m[i][1])*(cos(xim_m[i][0]*2.0+xim_m[i][1]*2.0-xim_m[i][2])*xim_m[i][8]+sin(xim_m[i][0]*2.0+xim_m[i][1]*2.0-xim_m[i][2])*xim_m[i][9]+cos(xim_m[i][1]*2.0+xim_m[i][2])*xim_m[i][8]*2.5E1+sin(xim_m[i][1]*2.0+xim_m[i][2])*xim_m[i][9]*2.5E1-cos(xim_m[i][2])*xim_m[i][8]*2.5E1+sin(xim_m[i][2])*xim_m[i][9]*2.5E1+cos(xim_m[i][0]*2.0+xim_m[i][1]*2.0)*xim_m[i][7]*2.0-cos(xim_m[i][0]*2.0-xim_m[i][2])*xim_m[i][8]+cos(xim_m[i][1]*2.0+xim_m[i][2]*2.0)*xim_m[i][7]*4.0+sin(xim_m[i][0]*2.0-xim_m[i][2])*xim_m[i][9]-xim_m[i][7]*4.6E1))/((sin(xim_m[i][0])*xim_m[i][5]-sin(xim_m[i][1])*xim_m[i][6])*(cos(xim_m[i][0]*2.0+xim_m[i][1]*2.0)*2.0+cos(xim_m[i][1]*2.0+xim_m[i][2]*2.0)*4.0-4.6E1));
	  PI_map(2,2) = 1.0;
	  PI_map(2,4) = xim_m[i][7]/(sin(xim_m[i][0])*xim_m[i][5]-sin(xim_m[i][1])*xim_m[i][6])-(cos(xim_m[i][0]*2.0+xim_m[i][1]*2.0-xim_m[i][2])*xim_m[i][8]+sin(xim_m[i][0]*2.0+xim_m[i][1]*2.0-xim_m[i][2])*xim_m[i][9]+cos(xim_m[i][1]*2.0+xim_m[i][2])*xim_m[i][8]*2.5E1+sin(xim_m[i][1]*2.0+xim_m[i][2])*xim_m[i][9]*2.5E1-cos(xim_m[i][2])*xim_m[i][8]*2.5E1+sin(xim_m[i][2])*xim_m[i][9]*2.5E1+cos(xim_m[i][0]*2.0+xim_m[i][1]*2.0)*xim_m[i][7]*2.0-cos(xim_m[i][0]*2.0-xim_m[i][2])*xim_m[i][8]+cos(xim_m[i][1]*2.0+xim_m[i][2]*2.0)*xim_m[i][7]*4.0+sin(xim_m[i][0]*2.0-xim_m[i][2])*xim_m[i][9]-xim_m[i][7]*4.6E1)/((sin(xim_m[i][0])*xim_m[i][5]-sin(xim_m[i][1])*xim_m[i][6])*(cos(xim_m[i][0]*2.0+xim_m[i][1]*2.0)*2.0+cos(xim_m[i][1]*2.0+xim_m[i][2]*2.0)*4.0-4.6E1));
	  PI_map(3,1) = (cos(xim_m[i][0])*sin(xim_m[i][1])*xim_m[i][5])/(sin(xim_m[i][0])*xim_m[i][5]-sin(xim_m[i][1])*xim_m[i][6])-(cos(xim_m[i][0])*sin(xim_m[i][1])*(cos(xim_m[i][0]+xim_m[i][1]*2.0)*xim_m[i][8]*-1.2E1+cos(xim_m[i][0]-xim_m[i][2]*2.0)*xim_m[i][8]-sin(xim_m[i][0]+xim_m[i][1]*2.0)*xim_m[i][9]*1.2E1+sin(xim_m[i][0]-xim_m[i][2]*2.0)*xim_m[i][9]+cos(xim_m[i][0])*xim_m[i][8]*1.2E1-sin(xim_m[i][0])*xim_m[i][9]*1.2E1-cos(xim_m[i][0]-xim_m[i][1]*2.0-xim_m[i][2]*2.0)*xim_m[i][8]+cos(xim_m[i][0]*2.0+xim_m[i][1]*2.0)*xim_m[i][5]+cos(xim_m[i][1]*2.0+xim_m[i][2]*2.0)*xim_m[i][5]*2.0+sin(xim_m[i][0]-xim_m[i][1]*2.0-xim_m[i][2]*2.0)*xim_m[i][9]-xim_m[i][5]*2.3E1))/((sin(xim_m[i][0])*xim_m[i][5]-sin(xim_m[i][1])*xim_m[i][6])*(cos(xim_m[i][0]*2.0+xim_m[i][1]*2.0)+cos(xim_m[i][1]*2.0+xim_m[i][2]*2.0)*2.0-2.3E1));
	  PI_map(3,3) = 1.0;
	  PI_map(3,4) = (cos(xim_m[i][0])*xim_m[i][5])/(sin(xim_m[i][0])*xim_m[i][5]-sin(xim_m[i][1])*xim_m[i][6])-(cos(xim_m[i][0])*(cos(xim_m[i][0]+xim_m[i][1]*2.0)*xim_m[i][8]*-1.2E1+cos(xim_m[i][0]-xim_m[i][2]*2.0)*xim_m[i][8]-sin(xim_m[i][0]+xim_m[i][1]*2.0)*xim_m[i][9]*1.2E1+sin(xim_m[i][0]-xim_m[i][2]*2.0)*xim_m[i][9]+cos(xim_m[i][0])*xim_m[i][8]*1.2E1-sin(xim_m[i][0])*xim_m[i][9]*1.2E1-cos(xim_m[i][0]-xim_m[i][1]*2.0-xim_m[i][2]*2.0)*xim_m[i][8]+cos(xim_m[i][0]*2.0+xim_m[i][1]*2.0)*xim_m[i][5]+cos(xim_m[i][1]*2.0+xim_m[i][2]*2.0)*xim_m[i][5]*2.0+sin(xim_m[i][0]-xim_m[i][1]*2.0-xim_m[i][2]*2.0)*xim_m[i][9]-xim_m[i][5]*2.3E1))/((sin(xim_m[i][0])*xim_m[i][5]-sin(xim_m[i][1])*xim_m[i][6])*(cos(xim_m[i][0]*2.0+xim_m[i][1]*2.0)+cos(xim_m[i][1]*2.0+xim_m[i][2]*2.0)*2.0-2.3E1));
	  PI_map(4,1) = -(sin(xim_m[i][0])*sin(xim_m[i][1])*xim_m[i][5])/(sin(xim_m[i][0])*xim_m[i][5]-sin(xim_m[i][1])*xim_m[i][6])+(sin(xim_m[i][0])*sin(xim_m[i][1])*(cos(xim_m[i][0]+xim_m[i][1]*2.0)*xim_m[i][8]*-1.2E1+cos(xim_m[i][0]-xim_m[i][2]*2.0)*xim_m[i][8]-sin(xim_m[i][0]+xim_m[i][1]*2.0)*xim_m[i][9]*1.2E1+sin(xim_m[i][0]-xim_m[i][2]*2.0)*xim_m[i][9]+cos(xim_m[i][0])*xim_m[i][8]*1.2E1-sin(xim_m[i][0])*xim_m[i][9]*1.2E1-cos(xim_m[i][0]-xim_m[i][1]*2.0-xim_m[i][2]*2.0)*xim_m[i][8]+cos(xim_m[i][0]*2.0+xim_m[i][1]*2.0)*xim_m[i][5]+cos(xim_m[i][1]*2.0+xim_m[i][2]*2.0)*xim_m[i][5]*2.0+sin(xim_m[i][0]-xim_m[i][1]*2.0-xim_m[i][2]*2.0)*xim_m[i][9]-xim_m[i][5]*2.3E1))/((sin(xim_m[i][0])*xim_m[i][5]-sin(xim_m[i][1])*xim_m[i][6])*(cos(xim_m[i][0]*2.0+xim_m[i][1]*2.0)+cos(xim_m[i][1]*2.0+xim_m[i][2]*2.0)*2.0-2.3E1));
	  PI_map(4,4) = -(sin(xim_m[i][0])*xim_m[i][5])/(sin(xim_m[i][0])*xim_m[i][5]-sin(xim_m[i][1])*xim_m[i][6])+(sin(xim_m[i][0])*(cos(xim_m[i][0]+xim_m[i][1]*2.0)*xim_m[i][8]*-1.2E1+cos(xim_m[i][0]-xim_m[i][2]*2.0)*xim_m[i][8]-sin(xim_m[i][0]+xim_m[i][1]*2.0)*xim_m[i][9]*1.2E1+sin(xim_m[i][0]-xim_m[i][2]*2.0)*xim_m[i][9]+cos(xim_m[i][0])*xim_m[i][8]*1.2E1-sin(xim_m[i][0])*xim_m[i][9]*1.2E1-cos(xim_m[i][0]-xim_m[i][1]*2.0-xim_m[i][2]*2.0)*xim_m[i][8]+cos(xim_m[i][0]*2.0+xim_m[i][1]*2.0)*xim_m[i][5]+cos(xim_m[i][1]*2.0+xim_m[i][2]*2.0)*xim_m[i][5]*2.0+sin(xim_m[i][0]-xim_m[i][1]*2.0-xim_m[i][2]*2.0)*xim_m[i][9]-xim_m[i][5]*2.3E1))/((sin(xim_m[i][0])*xim_m[i][5]-sin(xim_m[i][1])*xim_m[i][6])*(cos(xim_m[i][0]*2.0+xim_m[i][1]*2.0)+cos(xim_m[i][1]*2.0+xim_m[i][2]*2.0)*2.0-2.3E1))+1.0;
	  PI_map(5,0) = -(cos(xim_m[i][0]+xim_m[i][1]*2.0)*xim_m[i][9]*1.2E1-cos(xim_m[i][0]-xim_m[i][2]*2.0)*xim_m[i][9]-sin(xim_m[i][0]+xim_m[i][1]*2.0)*xim_m[i][8]*1.2E1+sin(xim_m[i][0]-xim_m[i][2]*2.0)*xim_m[i][8]+cos(xim_m[i][0])*xim_m[i][9]*1.2E1+sin(xim_m[i][0])*xim_m[i][8]*1.2E1-cos(xim_m[i][0]-xim_m[i][1]*2.0-xim_m[i][2]*2.0)*xim_m[i][9]-sin(xim_m[i][0]-xim_m[i][1]*2.0-xim_m[i][2]*2.0)*xim_m[i][8]+sin(xim_m[i][0]*2.0+xim_m[i][1]*2.0)*xim_m[i][5]*2.0)/(cos(xim_m[i][0]*2.0+xim_m[i][1]*2.0)+cos(xim_m[i][1]*2.0+xim_m[i][2]*2.0)*2.0-2.3E1)+sin(xim_m[i][0]*2.0+xim_m[i][1]*2.0)*1.0/pow(cos(xim_m[i][0]*2.0+xim_m[i][1]*2.0)+cos(xim_m[i][1]*2.0+xim_m[i][2]*2.0)*2.0-2.3E1,2.0)*(cos(xim_m[i][0]+xim_m[i][1]*2.0)*xim_m[i][8]*-1.2E1+cos(xim_m[i][0]-xim_m[i][2]*2.0)*xim_m[i][8]-sin(xim_m[i][0]+xim_m[i][1]*2.0)*xim_m[i][9]*1.2E1+sin(xim_m[i][0]-xim_m[i][2]*2.0)*xim_m[i][9]+cos(xim_m[i][0])*xim_m[i][8]*1.2E1-sin(xim_m[i][0])*xim_m[i][9]*1.2E1-cos(xim_m[i][0]-xim_m[i][1]*2.0-xim_m[i][2]*2.0)*xim_m[i][8]+cos(xim_m[i][0]*2.0+xim_m[i][1]*2.0)*xim_m[i][5]+cos(xim_m[i][1]*2.0+xim_m[i][2]*2.0)*xim_m[i][5]*2.0+sin(xim_m[i][0]-xim_m[i][1]*2.0-xim_m[i][2]*2.0)*xim_m[i][9]-xim_m[i][5]*2.3E1)*2.0;
	  PI_map(5,1) = -((sin(xim_m[i][1])*xim_m[i][6])/(sin(xim_m[i][0])*xim_m[i][5]-sin(xim_m[i][1])*xim_m[i][6])+1.0)*((cos(xim_m[i][0]+xim_m[i][1]*2.0)*xim_m[i][9]*2.4E1-sin(xim_m[i][0]+xim_m[i][1]*2.0)*xim_m[i][8]*2.4E1+cos(xim_m[i][0]-xim_m[i][1]*2.0-xim_m[i][2]*2.0)*xim_m[i][9]*2.0+sin(xim_m[i][0]-xim_m[i][1]*2.0-xim_m[i][2]*2.0)*xim_m[i][8]*2.0+sin(xim_m[i][0]*2.0+xim_m[i][1]*2.0)*xim_m[i][5]*2.0+sin(xim_m[i][1]*2.0+xim_m[i][2]*2.0)*xim_m[i][5]*4.0)/(cos(xim_m[i][0]*2.0+xim_m[i][1]*2.0)+cos(xim_m[i][1]*2.0+xim_m[i][2]*2.0)*2.0-2.3E1)-(sin(xim_m[i][0]*2.0+xim_m[i][1]*2.0)*2.0+sin(xim_m[i][1]*2.0+xim_m[i][2]*2.0)*4.0)*1.0/pow(cos(xim_m[i][0]*2.0+xim_m[i][1]*2.0)+cos(xim_m[i][1]*2.0+xim_m[i][2]*2.0)*2.0-2.3E1,2.0)*(cos(xim_m[i][0]+xim_m[i][1]*2.0)*xim_m[i][8]*-1.2E1+cos(xim_m[i][0]-xim_m[i][2]*2.0)*xim_m[i][8]-sin(xim_m[i][0]+xim_m[i][1]*2.0)*xim_m[i][9]*1.2E1+sin(xim_m[i][0]-xim_m[i][2]*2.0)*xim_m[i][9]+cos(xim_m[i][0])*xim_m[i][8]*1.2E1-sin(xim_m[i][0])*xim_m[i][9]*1.2E1-cos(xim_m[i][0]-xim_m[i][1]*2.0-xim_m[i][2]*2.0)*xim_m[i][8]+cos(xim_m[i][0]*2.0+xim_m[i][1]*2.0)*xim_m[i][5]+cos(xim_m[i][1]*2.0+xim_m[i][2]*2.0)*xim_m[i][5]*2.0+sin(xim_m[i][0]-xim_m[i][1]*2.0-xim_m[i][2]*2.0)*xim_m[i][9]-xim_m[i][5]*2.3E1))-(sin(xim_m[i][1])*((cos(xim_m[i][0]+xim_m[i][1]*2.0)*xim_m[i][9]*1.2E1-cos(xim_m[i][0]-xim_m[i][2]*2.0)*xim_m[i][9]-sin(xim_m[i][0]+xim_m[i][1]*2.0)*xim_m[i][8]*1.2E1+sin(xim_m[i][0]-xim_m[i][2]*2.0)*xim_m[i][8]+cos(xim_m[i][0])*xim_m[i][9]*1.2E1+sin(xim_m[i][0])*xim_m[i][8]*1.2E1-cos(xim_m[i][0]-xim_m[i][1]*2.0-xim_m[i][2]*2.0)*xim_m[i][9]-sin(xim_m[i][0]-xim_m[i][1]*2.0-xim_m[i][2]*2.0)*xim_m[i][8]+sin(xim_m[i][0]*2.0+xim_m[i][1]*2.0)*xim_m[i][5]*2.0)/(cos(xim_m[i][0]*2.0+xim_m[i][1]*2.0)+cos(xim_m[i][1]*2.0+xim_m[i][2]*2.0)*2.0-2.3E1)-sin(xim_m[i][0]*2.0+xim_m[i][1]*2.0)*1.0/pow(cos(xim_m[i][0]*2.0+xim_m[i][1]*2.0)+cos(xim_m[i][1]*2.0+xim_m[i][2]*2.0)*2.0-2.3E1,2.0)*(cos(xim_m[i][0]+xim_m[i][1]*2.0)*xim_m[i][8]*-1.2E1+cos(xim_m[i][0]-xim_m[i][2]*2.0)*xim_m[i][8]-sin(xim_m[i][0]+xim_m[i][1]*2.0)*xim_m[i][9]*1.2E1+sin(xim_m[i][0]-xim_m[i][2]*2.0)*xim_m[i][9]+cos(xim_m[i][0])*xim_m[i][8]*1.2E1-sin(xim_m[i][0])*xim_m[i][9]*1.2E1-cos(xim_m[i][0]-xim_m[i][1]*2.0-xim_m[i][2]*2.0)*xim_m[i][8]+cos(xim_m[i][0]*2.0+xim_m[i][1]*2.0)*xim_m[i][5]+cos(xim_m[i][1]*2.0+xim_m[i][2]*2.0)*xim_m[i][5]*2.0+sin(xim_m[i][0]-xim_m[i][1]*2.0-xim_m[i][2]*2.0)*xim_m[i][9]-xim_m[i][5]*2.3E1)*2.0)*xim_m[i][5])/(sin(xim_m[i][0])*xim_m[i][5]-sin(xim_m[i][1])*xim_m[i][6])+(sin(xim_m[i][1])*(sin(xim_m[i][0]+xim_m[i][1]*2.0)*(9.81E2/2.0)+sin(xim_m[i][0]-xim_m[i][2]*2.0)*9.81E2+sin(xim_m[i][0])*1.12815E4+cos(xim_m[i][0]-xim_m[i][2])*uim[0]*4.0E1+cos(xim_m[i][0]-xim_m[i][2])*uim[1]*4.0E1+uim[0]*4.0E1+cos(xim_m[i][0]+xim_m[i][1])*uim[1]*4.0E1-sin(xim_m[i][0]*2.0+xim_m[i][1]*2.0)*1.0/pow(cos(xim_m[i][0]*2.0+xim_m[i][1]*2.0)+cos(xim_m[i][1]*2.0+xim_m[i][2]*2.0)*2.0-2.3E1,2.0)*pow(cos(xim_m[i][0]+xim_m[i][1]*2.0)*xim_m[i][8]*-1.2E1+cos(xim_m[i][0]-xim_m[i][2]*2.0)*xim_m[i][8]-sin(xim_m[i][0]+xim_m[i][1]*2.0)*xim_m[i][9]*1.2E1+sin(xim_m[i][0]-xim_m[i][2]*2.0)*xim_m[i][9]+cos(xim_m[i][0])*xim_m[i][8]*1.2E1-sin(xim_m[i][0])*xim_m[i][9]*1.2E1-cos(xim_m[i][0]-xim_m[i][1]*2.0-xim_m[i][2]*2.0)*xim_m[i][8]+cos(xim_m[i][0]*2.0+xim_m[i][1]*2.0)*xim_m[i][5]+cos(xim_m[i][1]*2.0+xim_m[i][2]*2.0)*xim_m[i][5]*2.0+sin(xim_m[i][0]-xim_m[i][1]*2.0-xim_m[i][2]*2.0)*xim_m[i][9]-xim_m[i][5]*2.3E1,2.0)*5.0E1-sin(xim_m[i][0]*2.0-xim_m[i][2]*2.0)*1.0/pow(cos(xim_m[i][0]*2.0+xim_m[i][1]*2.0)+cos(xim_m[i][1]*2.0+xim_m[i][2]*2.0)*2.0-2.3E1,2.0)*pow(cos(xim_m[i][0]+xim_m[i][1]*2.0)*xim_m[i][8]*-1.2E1+cos(xim_m[i][0]-xim_m[i][2]*2.0)*xim_m[i][8]-sin(xim_m[i][0]+xim_m[i][1]*2.0)*xim_m[i][9]*1.2E1+sin(xim_m[i][0]-xim_m[i][2]*2.0)*xim_m[i][9]+cos(xim_m[i][0])*xim_m[i][8]*1.2E1-sin(xim_m[i][0])*xim_m[i][9]*1.2E1-cos(xim_m[i][0]-xim_m[i][1]*2.0-xim_m[i][2]*2.0)*xim_m[i][8]+cos(xim_m[i][0]*2.0+xim_m[i][1]*2.0)*xim_m[i][5]+cos(xim_m[i][1]*2.0+xim_m[i][2]*2.0)*xim_m[i][5]*2.0+sin(xim_m[i][0]-xim_m[i][1]*2.0-xim_m[i][2]*2.0)*xim_m[i][9]-xim_m[i][5]*2.3E1,2.0)*1.0E2+sin(xim_m[i][0]+xim_m[i][1])*1.0/pow(cos(xim_m[i][0]*2.0+xim_m[i][1]*2.0)+cos(xim_m[i][1]*2.0+xim_m[i][2]*2.0)*2.0-2.3E1,2.0)*pow(-cos(xim_m[i][0]*2.0+xim_m[i][1])*xim_m[i][8]-cos(xim_m[i][1]+xim_m[i][2]*2.0)*xim_m[i][8]*2.0+sin(xim_m[i][0]*2.0+xim_m[i][1])*xim_m[i][9]+sin(xim_m[i][1]+xim_m[i][2]*2.0)*xim_m[i][9]*2.0+cos(xim_m[i][1])*xim_m[i][8]*2.3E1+sin(xim_m[i][1])*xim_m[i][9]*2.3E1,2.0)*1.0E2-sin(xim_m[i][0]-xim_m[i][2])*1.0/pow(cos(xim_m[i][0]*2.0+xim_m[i][1]*2.0)*2.0+cos(xim_m[i][1]*2.0+xim_m[i][2]*2.0)*4.0-4.6E1,2.0)*pow(cos(xim_m[i][0]*2.0+xim_m[i][1]*2.0-xim_m[i][2])*xim_m[i][8]+sin(xim_m[i][0]*2.0+xim_m[i][1]*2.0-xim_m[i][2])*xim_m[i][9]+cos(xim_m[i][1]*2.0+xim_m[i][2])*xim_m[i][8]*2.5E1+sin(xim_m[i][1]*2.0+xim_m[i][2])*xim_m[i][9]*2.5E1-cos(xim_m[i][2])*xim_m[i][8]*2.5E1+sin(xim_m[i][2])*xim_m[i][9]*2.5E1+cos(xim_m[i][0]*2.0+xim_m[i][1]*2.0)*xim_m[i][7]*2.0-cos(xim_m[i][0]*2.0-xim_m[i][2])*xim_m[i][8]+cos(xim_m[i][1]*2.0+xim_m[i][2]*2.0)*xim_m[i][7]*4.0+sin(xim_m[i][0]*2.0-xim_m[i][2])*xim_m[i][9]-xim_m[i][7]*4.6E1,2.0)*2.0E2)*(1.0/5.0E1))/((sin(xim_m[i][0])*xim_m[i][5]-sin(xim_m[i][1])*xim_m[i][6])*(cos(xim_m[i][0]*2.0+xim_m[i][1]*2.0)+cos(xim_m[i][0]*2.0-xim_m[i][2]*2.0)*2.0-2.3E1))-(sin(xim_m[i][1])*((cos(xim_m[i][0]-xim_m[i][2]*2.0)*xim_m[i][9]*2.0-sin(xim_m[i][0]-xim_m[i][2]*2.0)*xim_m[i][8]*2.0+cos(xim_m[i][0]-xim_m[i][1]*2.0-xim_m[i][2]*2.0)*xim_m[i][9]*2.0+sin(xim_m[i][0]-xim_m[i][1]*2.0-xim_m[i][2]*2.0)*xim_m[i][8]*2.0+sin(xim_m[i][1]*2.0+xim_m[i][2]*2.0)*xim_m[i][5]*4.0)/(cos(xim_m[i][0]*2.0+xim_m[i][1]*2.0)+cos(xim_m[i][1]*2.0+xim_m[i][2]*2.0)*2.0-2.3E1)-sin(xim_m[i][1]*2.0+xim_m[i][2]*2.0)*1.0/pow(cos(xim_m[i][0]*2.0+xim_m[i][1]*2.0)+cos(xim_m[i][1]*2.0+xim_m[i][2]*2.0)*2.0-2.3E1,2.0)*(cos(xim_m[i][0]+xim_m[i][1]*2.0)*xim_m[i][8]*-1.2E1+cos(xim_m[i][0]-xim_m[i][2]*2.0)*xim_m[i][8]-sin(xim_m[i][0]+xim_m[i][1]*2.0)*xim_m[i][9]*1.2E1+sin(xim_m[i][0]-xim_m[i][2]*2.0)*xim_m[i][9]+cos(xim_m[i][0])*xim_m[i][8]*1.2E1-sin(xim_m[i][0])*xim_m[i][9]*1.2E1-cos(xim_m[i][0]-xim_m[i][1]*2.0-xim_m[i][2]*2.0)*xim_m[i][8]+cos(xim_m[i][0]*2.0+xim_m[i][1]*2.0)*xim_m[i][5]+cos(xim_m[i][1]*2.0+xim_m[i][2]*2.0)*xim_m[i][5]*2.0+sin(xim_m[i][0]-xim_m[i][1]*2.0-xim_m[i][2]*2.0)*xim_m[i][9]-xim_m[i][5]*2.3E1)*4.0)*xim_m[i][7])/(sin(xim_m[i][0])*xim_m[i][5]-sin(xim_m[i][1])*xim_m[i][6])-(sin(xim_m[i][1])*(sin(xim_m[i][0]+xim_m[i][1]*2.0)*(9.81E2/2.0)+sin(xim_m[i][0]-xim_m[i][2]*2.0)*9.81E2+sin(xim_m[i][0])*1.12815E4-sin(xim_m[i][0]*2.0+xim_m[i][1]*2.0)*(xim_m[i][5]*xim_m[i][5])*5.0E1-sin(xim_m[i][0]*2.0-xim_m[i][2]*2.0)*(xim_m[i][5]*xim_m[i][5])*1.0E2+cos(xim_m[i][0]-xim_m[i][2])*uim[0]*4.0E1+cos(xim_m[i][0]-xim_m[i][2])*uim[1]*4.0E1+sin(xim_m[i][0]+xim_m[i][1])*(xim_m[i][6]*xim_m[i][6])*1.0E2+uim[0]*4.0E1-sin(xim_m[i][0]-xim_m[i][2])*(xim_m[i][7]*xim_m[i][7])*2.0E2+cos(xim_m[i][0]+xim_m[i][1])*uim[1]*4.0E1)*(1.0/5.0E1))/((sin(xim_m[i][0])*xim_m[i][5]-sin(xim_m[i][1])*xim_m[i][6])*(cos(xim_m[i][0]*2.0+xim_m[i][1]*2.0)+cos(xim_m[i][0]*2.0-xim_m[i][2]*2.0)*2.0-2.3E1));
	  PI_map(5,2) = -(cos(xim_m[i][0]-xim_m[i][2]*2.0)*xim_m[i][9]*2.0-sin(xim_m[i][0]-xim_m[i][2]*2.0)*xim_m[i][8]*2.0+cos(xim_m[i][0]-xim_m[i][1]*2.0-xim_m[i][2]*2.0)*xim_m[i][9]*2.0+sin(xim_m[i][0]-xim_m[i][1]*2.0-xim_m[i][2]*2.0)*xim_m[i][8]*2.0+sin(xim_m[i][1]*2.0+xim_m[i][2]*2.0)*xim_m[i][5]*4.0)/(cos(xim_m[i][0]*2.0+xim_m[i][1]*2.0)+cos(xim_m[i][1]*2.0+xim_m[i][2]*2.0)*2.0-2.3E1)+sin(xim_m[i][1]*2.0+xim_m[i][2]*2.0)*1.0/pow(cos(xim_m[i][0]*2.0+xim_m[i][1]*2.0)+cos(xim_m[i][1]*2.0+xim_m[i][2]*2.0)*2.0-2.3E1,2.0)*(cos(xim_m[i][0]+xim_m[i][1]*2.0)*xim_m[i][8]*-1.2E1+cos(xim_m[i][0]-xim_m[i][2]*2.0)*xim_m[i][8]-sin(xim_m[i][0]+xim_m[i][1]*2.0)*xim_m[i][9]*1.2E1+sin(xim_m[i][0]-xim_m[i][2]*2.0)*xim_m[i][9]+cos(xim_m[i][0])*xim_m[i][8]*1.2E1-sin(xim_m[i][0])*xim_m[i][9]*1.2E1-cos(xim_m[i][0]-xim_m[i][1]*2.0-xim_m[i][2]*2.0)*xim_m[i][8]+cos(xim_m[i][0]*2.0+xim_m[i][1]*2.0)*xim_m[i][5]+cos(xim_m[i][1]*2.0+xim_m[i][2]*2.0)*xim_m[i][5]*2.0+sin(xim_m[i][0]-xim_m[i][1]*2.0-xim_m[i][2]*2.0)*xim_m[i][9]-xim_m[i][5]*2.3E1)*4.0;
	  PI_map(5,4) = (sin(xim_m[i][0]+xim_m[i][1]*2.0)*(-9.81E2/1.0E2)-sin(xim_m[i][0]-xim_m[i][2]*2.0)*(9.81E2/5.0E1)-sin(xim_m[i][0])*2.2563E2+sin(xim_m[i][0]*2.0+xim_m[i][1]*2.0)*(xim_m[i][5]*xim_m[i][5])+sin(xim_m[i][0]*2.0-xim_m[i][2]*2.0)*(xim_m[i][5]*xim_m[i][5])*2.0-cos(xim_m[i][0]-xim_m[i][2])*uim[0]*(4.0/5.0)-cos(xim_m[i][0]-xim_m[i][2])*uim[1]*(4.0/5.0)-sin(xim_m[i][0]+xim_m[i][1])*(xim_m[i][6]*xim_m[i][6])*2.0-uim[0]*(4.0/5.0)+sin(xim_m[i][0]-xim_m[i][2])*(xim_m[i][7]*xim_m[i][7])*4.0-cos(xim_m[i][0]+xim_m[i][1])*uim[1]*(4.0/5.0))/((sin(xim_m[i][0])*xim_m[i][5]-sin(xim_m[i][1])*xim_m[i][6])*(cos(xim_m[i][0]*2.0+xim_m[i][1]*2.0)+cos(xim_m[i][0]*2.0-xim_m[i][2]*2.0)*2.0-2.3E1))-(((cos(xim_m[i][0]+xim_m[i][1]*2.0)*xim_m[i][9]*2.4E1-sin(xim_m[i][0]+xim_m[i][1]*2.0)*xim_m[i][8]*2.4E1+cos(xim_m[i][0]-xim_m[i][1]*2.0-xim_m[i][2]*2.0)*xim_m[i][9]*2.0+sin(xim_m[i][0]-xim_m[i][1]*2.0-xim_m[i][2]*2.0)*xim_m[i][8]*2.0+sin(xim_m[i][0]*2.0+xim_m[i][1]*2.0)*xim_m[i][5]*2.0+sin(xim_m[i][1]*2.0+xim_m[i][2]*2.0)*xim_m[i][5]*4.0)/(cos(xim_m[i][0]*2.0+xim_m[i][1]*2.0)+cos(xim_m[i][1]*2.0+xim_m[i][2]*2.0)*2.0-2.3E1)-(sin(xim_m[i][0]*2.0+xim_m[i][1]*2.0)*2.0+sin(xim_m[i][1]*2.0+xim_m[i][2]*2.0)*4.0)*1.0/pow(cos(xim_m[i][0]*2.0+xim_m[i][1]*2.0)+cos(xim_m[i][1]*2.0+xim_m[i][2]*2.0)*2.0-2.3E1,2.0)*(cos(xim_m[i][0]+xim_m[i][1]*2.0)*xim_m[i][8]*-1.2E1+cos(xim_m[i][0]-xim_m[i][2]*2.0)*xim_m[i][8]-sin(xim_m[i][0]+xim_m[i][1]*2.0)*xim_m[i][9]*1.2E1+sin(xim_m[i][0]-xim_m[i][2]*2.0)*xim_m[i][9]+cos(xim_m[i][0])*xim_m[i][8]*1.2E1-sin(xim_m[i][0])*xim_m[i][9]*1.2E1-cos(xim_m[i][0]-xim_m[i][1]*2.0-xim_m[i][2]*2.0)*xim_m[i][8]+cos(xim_m[i][0]*2.0+xim_m[i][1]*2.0)*xim_m[i][5]+cos(xim_m[i][1]*2.0+xim_m[i][2]*2.0)*xim_m[i][5]*2.0+sin(xim_m[i][0]-xim_m[i][1]*2.0-xim_m[i][2]*2.0)*xim_m[i][9]-xim_m[i][5]*2.3E1))*xim_m[i][6])/(sin(xim_m[i][0])*xim_m[i][5]-sin(xim_m[i][1])*xim_m[i][6])-(((cos(xim_m[i][0]+xim_m[i][1]*2.0)*xim_m[i][9]*1.2E1-cos(xim_m[i][0]-xim_m[i][2]*2.0)*xim_m[i][9]-sin(xim_m[i][0]+xim_m[i][1]*2.0)*xim_m[i][8]*1.2E1+sin(xim_m[i][0]-xim_m[i][2]*2.0)*xim_m[i][8]+cos(xim_m[i][0])*xim_m[i][9]*1.2E1+sin(xim_m[i][0])*xim_m[i][8]*1.2E1-cos(xim_m[i][0]-xim_m[i][1]*2.0-xim_m[i][2]*2.0)*xim_m[i][9]-sin(xim_m[i][0]-xim_m[i][1]*2.0-xim_m[i][2]*2.0)*xim_m[i][8]+sin(xim_m[i][0]*2.0+xim_m[i][1]*2.0)*xim_m[i][5]*2.0)/(cos(xim_m[i][0]*2.0+xim_m[i][1]*2.0)+cos(xim_m[i][1]*2.0+xim_m[i][2]*2.0)*2.0-2.3E1)-sin(xim_m[i][0]*2.0+xim_m[i][1]*2.0)*1.0/pow(cos(xim_m[i][0]*2.0+xim_m[i][1]*2.0)+cos(xim_m[i][1]*2.0+xim_m[i][2]*2.0)*2.0-2.3E1,2.0)*(cos(xim_m[i][0]+xim_m[i][1]*2.0)*xim_m[i][8]*-1.2E1+cos(xim_m[i][0]-xim_m[i][2]*2.0)*xim_m[i][8]-sin(xim_m[i][0]+xim_m[i][1]*2.0)*xim_m[i][9]*1.2E1+sin(xim_m[i][0]-xim_m[i][2]*2.0)*xim_m[i][9]+cos(xim_m[i][0])*xim_m[i][8]*1.2E1-sin(xim_m[i][0])*xim_m[i][9]*1.2E1-cos(xim_m[i][0]-xim_m[i][1]*2.0-xim_m[i][2]*2.0)*xim_m[i][8]+cos(xim_m[i][0]*2.0+xim_m[i][1]*2.0)*xim_m[i][5]+cos(xim_m[i][1]*2.0+xim_m[i][2]*2.0)*xim_m[i][5]*2.0+sin(xim_m[i][0]-xim_m[i][1]*2.0-xim_m[i][2]*2.0)*xim_m[i][9]-xim_m[i][5]*2.3E1)*2.0)*xim_m[i][5])/(sin(xim_m[i][0])*xim_m[i][5]-sin(xim_m[i][1])*xim_m[i][6])+(sin(xim_m[i][0]+xim_m[i][1]*2.0)*(9.81E2/1.0E2)+sin(xim_m[i][0]-xim_m[i][2]*2.0)*(9.81E2/5.0E1)+sin(xim_m[i][0])*2.2563E2+cos(xim_m[i][0]-xim_m[i][2])*uim[0]*(4.0/5.0)+cos(xim_m[i][0]-xim_m[i][2])*uim[1]*(4.0/5.0)+uim[0]*(4.0/5.0)+cos(xim_m[i][0]+xim_m[i][1])*uim[1]*(4.0/5.0)-sin(xim_m[i][0]*2.0+xim_m[i][1]*2.0)*1.0/pow(cos(xim_m[i][0]*2.0+xim_m[i][1]*2.0)+cos(xim_m[i][1]*2.0+xim_m[i][2]*2.0)*2.0-2.3E1,2.0)*pow(cos(xim_m[i][0]+xim_m[i][1]*2.0)*xim_m[i][8]*-1.2E1+cos(xim_m[i][0]-xim_m[i][2]*2.0)*xim_m[i][8]-sin(xim_m[i][0]+xim_m[i][1]*2.0)*xim_m[i][9]*1.2E1+sin(xim_m[i][0]-xim_m[i][2]*2.0)*xim_m[i][9]+cos(xim_m[i][0])*xim_m[i][8]*1.2E1-sin(xim_m[i][0])*xim_m[i][9]*1.2E1-cos(xim_m[i][0]-xim_m[i][1]*2.0-xim_m[i][2]*2.0)*xim_m[i][8]+cos(xim_m[i][0]*2.0+xim_m[i][1]*2.0)*xim_m[i][5]+cos(xim_m[i][1]*2.0+xim_m[i][2]*2.0)*xim_m[i][5]*2.0+sin(xim_m[i][0]-xim_m[i][1]*2.0-xim_m[i][2]*2.0)*xim_m[i][9]-xim_m[i][5]*2.3E1,2.0)-sin(xim_m[i][0]*2.0-xim_m[i][2]*2.0)*1.0/pow(cos(xim_m[i][0]*2.0+xim_m[i][1]*2.0)+cos(xim_m[i][1]*2.0+xim_m[i][2]*2.0)*2.0-2.3E1,2.0)*pow(cos(xim_m[i][0]+xim_m[i][1]*2.0)*xim_m[i][8]*-1.2E1+cos(xim_m[i][0]-xim_m[i][2]*2.0)*xim_m[i][8]-sin(xim_m[i][0]+xim_m[i][1]*2.0)*xim_m[i][9]*1.2E1+sin(xim_m[i][0]-xim_m[i][2]*2.0)*xim_m[i][9]+cos(xim_m[i][0])*xim_m[i][8]*1.2E1-sin(xim_m[i][0])*xim_m[i][9]*1.2E1-cos(xim_m[i][0]-xim_m[i][1]*2.0-xim_m[i][2]*2.0)*xim_m[i][8]+cos(xim_m[i][0]*2.0+xim_m[i][1]*2.0)*xim_m[i][5]+cos(xim_m[i][1]*2.0+xim_m[i][2]*2.0)*xim_m[i][5]*2.0+sin(xim_m[i][0]-xim_m[i][1]*2.0-xim_m[i][2]*2.0)*xim_m[i][9]-xim_m[i][5]*2.3E1,2.0)*2.0+sin(xim_m[i][0]+xim_m[i][1])*1.0/pow(cos(xim_m[i][0]*2.0+xim_m[i][1]*2.0)+cos(xim_m[i][1]*2.0+xim_m[i][2]*2.0)*2.0-2.3E1,2.0)*pow(-cos(xim_m[i][0]*2.0+xim_m[i][1])*xim_m[i][8]-cos(xim_m[i][1]+xim_m[i][2]*2.0)*xim_m[i][8]*2.0+sin(xim_m[i][0]*2.0+xim_m[i][1])*xim_m[i][9]+sin(xim_m[i][1]+xim_m[i][2]*2.0)*xim_m[i][9]*2.0+cos(xim_m[i][1])*xim_m[i][8]*2.3E1+sin(xim_m[i][1])*xim_m[i][9]*2.3E1,2.0)*2.0-sin(xim_m[i][0]-xim_m[i][2])*1.0/pow(cos(xim_m[i][0]*2.0+xim_m[i][1]*2.0)*2.0+cos(xim_m[i][1]*2.0+xim_m[i][2]*2.0)*4.0-4.6E1,2.0)*pow(cos(xim_m[i][0]*2.0+xim_m[i][1]*2.0-xim_m[i][2])*xim_m[i][8]+sin(xim_m[i][0]*2.0+xim_m[i][1]*2.0-xim_m[i][2])*xim_m[i][9]+cos(xim_m[i][1]*2.0+xim_m[i][2])*xim_m[i][8]*2.5E1+sin(xim_m[i][1]*2.0+xim_m[i][2])*xim_m[i][9]*2.5E1-cos(xim_m[i][2])*xim_m[i][8]*2.5E1+sin(xim_m[i][2])*xim_m[i][9]*2.5E1+cos(xim_m[i][0]*2.0+xim_m[i][1]*2.0)*xim_m[i][7]*2.0-cos(xim_m[i][0]*2.0-xim_m[i][2])*xim_m[i][8]+cos(xim_m[i][1]*2.0+xim_m[i][2]*2.0)*xim_m[i][7]*4.0+sin(xim_m[i][0]*2.0-xim_m[i][2])*xim_m[i][9]-xim_m[i][7]*4.6E1,2.0)*4.0)/((sin(xim_m[i][0])*xim_m[i][5]-sin(xim_m[i][1])*xim_m[i][6])*(cos(xim_m[i][0]*2.0+xim_m[i][1]*2.0)+cos(xim_m[i][0]*2.0-xim_m[i][2]*2.0)*2.0-2.3E1))-(((cos(xim_m[i][0]-xim_m[i][2]*2.0)*xim_m[i][9]*2.0-sin(xim_m[i][0]-xim_m[i][2]*2.0)*xim_m[i][8]*2.0+cos(xim_m[i][0]-xim_m[i][1]*2.0-xim_m[i][2]*2.0)*xim_m[i][9]*2.0+sin(xim_m[i][0]-xim_m[i][1]*2.0-xim_m[i][2]*2.0)*xim_m[i][8]*2.0+sin(xim_m[i][1]*2.0+xim_m[i][2]*2.0)*xim_m[i][5]*4.0)/(cos(xim_m[i][0]*2.0+xim_m[i][1]*2.0)+cos(xim_m[i][1]*2.0+xim_m[i][2]*2.0)*2.0-2.3E1)-sin(xim_m[i][1]*2.0+xim_m[i][2]*2.0)*1.0/pow(cos(xim_m[i][0]*2.0+xim_m[i][1]*2.0)+cos(xim_m[i][1]*2.0+xim_m[i][2]*2.0)*2.0-2.3E1,2.0)*(cos(xim_m[i][0]+xim_m[i][1]*2.0)*xim_m[i][8]*-1.2E1+cos(xim_m[i][0]-xim_m[i][2]*2.0)*xim_m[i][8]-sin(xim_m[i][0]+xim_m[i][1]*2.0)*xim_m[i][9]*1.2E1+sin(xim_m[i][0]-xim_m[i][2]*2.0)*xim_m[i][9]+cos(xim_m[i][0])*xim_m[i][8]*1.2E1-sin(xim_m[i][0])*xim_m[i][9]*1.2E1-cos(xim_m[i][0]-xim_m[i][1]*2.0-xim_m[i][2]*2.0)*xim_m[i][8]+cos(xim_m[i][0]*2.0+xim_m[i][1]*2.0)*xim_m[i][5]+cos(xim_m[i][1]*2.0+xim_m[i][2]*2.0)*xim_m[i][5]*2.0+sin(xim_m[i][0]-xim_m[i][1]*2.0-xim_m[i][2]*2.0)*xim_m[i][9]-xim_m[i][5]*2.3E1)*4.0)*xim_m[i][7])/(sin(xim_m[i][0])*xim_m[i][5]-sin(xim_m[i][1])*xim_m[i][6]);
	  PI_map(5,5) = 1.0;
	  PI_map(5,8) = -(cos(xim_m[i][0]+xim_m[i][1]*2.0)*1.2E1-cos(xim_m[i][0]-xim_m[i][2]*2.0)-cos(xim_m[i][0])*1.2E1+cos(xim_m[i][0]-xim_m[i][1]*2.0-xim_m[i][2]*2.0))/(cos(xim_m[i][0]*2.0+xim_m[i][1]*2.0)+cos(xim_m[i][1]*2.0+xim_m[i][2]*2.0)*2.0-2.3E1);
	  PI_map(5,9) = -(sin(xim_m[i][0]+xim_m[i][1]*2.0)*1.2E1-sin(xim_m[i][0]-xim_m[i][2]*2.0)+sin(xim_m[i][0])*1.2E1-sin(xim_m[i][0]-xim_m[i][1]*2.0-xim_m[i][2]*2.0))/(cos(xim_m[i][0]*2.0+xim_m[i][1]*2.0)+cos(xim_m[i][1]*2.0+xim_m[i][2]*2.0)*2.0-2.3E1);
	  PI_map(6,0) = (cos(xim_m[i][0]*2.0+xim_m[i][1])*xim_m[i][9]*2.0+sin(xim_m[i][0]*2.0+xim_m[i][1])*xim_m[i][8]*2.0)/(cos(xim_m[i][0]*2.0+xim_m[i][1]*2.0)+cos(xim_m[i][1]*2.0+xim_m[i][2]*2.0)*2.0-2.3E1)+sin(xim_m[i][0]*2.0+xim_m[i][1]*2.0)*1.0/pow(cos(xim_m[i][0]*2.0+xim_m[i][1]*2.0)+cos(xim_m[i][1]*2.0+xim_m[i][2]*2.0)*2.0-2.3E1,2.0)*(-cos(xim_m[i][0]*2.0+xim_m[i][1])*xim_m[i][8]-cos(xim_m[i][1]+xim_m[i][2]*2.0)*xim_m[i][8]*2.0+sin(xim_m[i][0]*2.0+xim_m[i][1])*xim_m[i][9]+sin(xim_m[i][1]+xim_m[i][2]*2.0)*xim_m[i][9]*2.0+cos(xim_m[i][1])*xim_m[i][8]*2.3E1+sin(xim_m[i][1])*xim_m[i][9]*2.3E1)*2.0;
	  PI_map(6,1) = ((sin(xim_m[i][1])*xim_m[i][6])/(sin(xim_m[i][0])*xim_m[i][5]-sin(xim_m[i][1])*xim_m[i][6])+1.0)*((cos(xim_m[i][0]*2.0+xim_m[i][1])*xim_m[i][9]+cos(xim_m[i][1]+xim_m[i][2]*2.0)*xim_m[i][9]*2.0+sin(xim_m[i][0]*2.0+xim_m[i][1])*xim_m[i][8]+sin(xim_m[i][1]+xim_m[i][2]*2.0)*xim_m[i][8]*2.0+cos(xim_m[i][1])*xim_m[i][9]*2.3E1-sin(xim_m[i][1])*xim_m[i][8]*2.3E1)/(cos(xim_m[i][0]*2.0+xim_m[i][1]*2.0)+cos(xim_m[i][1]*2.0+xim_m[i][2]*2.0)*2.0-2.3E1)+(sin(xim_m[i][0]*2.0+xim_m[i][1]*2.0)*2.0+sin(xim_m[i][1]*2.0+xim_m[i][2]*2.0)*4.0)*1.0/pow(cos(xim_m[i][0]*2.0+xim_m[i][1]*2.0)+cos(xim_m[i][1]*2.0+xim_m[i][2]*2.0)*2.0-2.3E1,2.0)*(-cos(xim_m[i][0]*2.0+xim_m[i][1])*xim_m[i][8]-cos(xim_m[i][1]+xim_m[i][2]*2.0)*xim_m[i][8]*2.0+sin(xim_m[i][0]*2.0+xim_m[i][1])*xim_m[i][9]+sin(xim_m[i][1]+xim_m[i][2]*2.0)*xim_m[i][9]*2.0+cos(xim_m[i][1])*xim_m[i][8]*2.3E1+sin(xim_m[i][1])*xim_m[i][9]*2.3E1))+(sin(xim_m[i][1])*(((pow(cos(xim_m[i][0]-xim_m[i][2]),2.0)*2.0-1.3E1)*(sin(xim_m[i][1])*(9.81E2/4.0E1)+uim[1]-sin(xim_m[i][0]+xim_m[i][1])*1.0/pow(cos(xim_m[i][0]*2.0+xim_m[i][1]*2.0)+cos(xim_m[i][1]*2.0+xim_m[i][2]*2.0)*2.0-2.3E1,2.0)*pow(cos(xim_m[i][0]+xim_m[i][1]*2.0)*xim_m[i][8]*-1.2E1+cos(xim_m[i][0]-xim_m[i][2]*2.0)*xim_m[i][8]-sin(xim_m[i][0]+xim_m[i][1]*2.0)*xim_m[i][9]*1.2E1+sin(xim_m[i][0]-xim_m[i][2]*2.0)*xim_m[i][9]+cos(xim_m[i][0])*xim_m[i][8]*1.2E1-sin(xim_m[i][0])*xim_m[i][9]*1.2E1-cos(xim_m[i][0]-xim_m[i][1]*2.0-xim_m[i][2]*2.0)*xim_m[i][8]+cos(xim_m[i][0]*2.0+xim_m[i][1]*2.0)*xim_m[i][5]+cos(xim_m[i][1]*2.0+xim_m[i][2]*2.0)*xim_m[i][5]*2.0+sin(xim_m[i][0]-xim_m[i][1]*2.0-xim_m[i][2]*2.0)*xim_m[i][9]-xim_m[i][5]*2.3E1,2.0)*(5.0/2.0))*(2.0/5.0))/(pow(cos(xim_m[i][0]+xim_m[i][1]),2.0)+pow(cos(xim_m[i][0]-xim_m[i][2]),2.0)*2.0-1.3E1)-(cos(xim_m[i][0]+xim_m[i][1])*(sin(xim_m[i][0])*3.18825E2+uim[0]+sin(xim_m[i][0]+xim_m[i][1])*1.0/pow(cos(xim_m[i][0]*2.0+xim_m[i][1]*2.0)+cos(xim_m[i][1]*2.0+xim_m[i][2]*2.0)*2.0-2.3E1,2.0)*pow(-cos(xim_m[i][0]*2.0+xim_m[i][1])*xim_m[i][8]-cos(xim_m[i][1]+xim_m[i][2]*2.0)*xim_m[i][8]*2.0+sin(xim_m[i][0]*2.0+xim_m[i][1])*xim_m[i][9]+sin(xim_m[i][1]+xim_m[i][2]*2.0)*xim_m[i][9]*2.0+cos(xim_m[i][1])*xim_m[i][8]*2.3E1+sin(xim_m[i][1])*xim_m[i][9]*2.3E1,2.0)*(5.0/2.0)-sin(xim_m[i][0]-xim_m[i][2])*1.0/pow(cos(xim_m[i][0]*2.0+xim_m[i][1]*2.0)*2.0+cos(xim_m[i][1]*2.0+xim_m[i][2]*2.0)*4.0-4.6E1,2.0)*pow(cos(xim_m[i][0]*2.0+xim_m[i][1]*2.0-xim_m[i][2])*xim_m[i][8]+sin(xim_m[i][0]*2.0+xim_m[i][1]*2.0-xim_m[i][2])*xim_m[i][9]+cos(xim_m[i][1]*2.0+xim_m[i][2])*xim_m[i][8]*2.5E1+sin(xim_m[i][1]*2.0+xim_m[i][2])*xim_m[i][9]*2.5E1-cos(xim_m[i][2])*xim_m[i][8]*2.5E1+sin(xim_m[i][2])*xim_m[i][9]*2.5E1+cos(xim_m[i][0]*2.0+xim_m[i][1]*2.0)*xim_m[i][7]*2.0-cos(xim_m[i][0]*2.0-xim_m[i][2])*xim_m[i][8]+cos(xim_m[i][1]*2.0+xim_m[i][2]*2.0)*xim_m[i][7]*4.0+sin(xim_m[i][0]*2.0-xim_m[i][2])*xim_m[i][9]-xim_m[i][7]*4.6E1,2.0)*5.0)*(2.0/5.0))/(pow(cos(xim_m[i][0]+xim_m[i][1]),2.0)+pow(cos(xim_m[i][0]-xim_m[i][2]),2.0)*2.0-1.3E1)+(cos(xim_m[i][0]-xim_m[i][2])*cos(xim_m[i][0]+xim_m[i][1])*(sin(xim_m[i][2])*(9.81E2/2.0E1)-uim[0]-uim[1]+sin(xim_m[i][0]-xim_m[i][2])*1.0/pow(cos(xim_m[i][0]*2.0+xim_m[i][1]*2.0)+cos(xim_m[i][1]*2.0+xim_m[i][2]*2.0)*2.0-2.3E1,2.0)*pow(cos(xim_m[i][0]+xim_m[i][1]*2.0)*xim_m[i][8]*-1.2E1+cos(xim_m[i][0]-xim_m[i][2]*2.0)*xim_m[i][8]-sin(xim_m[i][0]+xim_m[i][1]*2.0)*xim_m[i][9]*1.2E1+sin(xim_m[i][0]-xim_m[i][2]*2.0)*xim_m[i][9]+cos(xim_m[i][0])*xim_m[i][8]*1.2E1-sin(xim_m[i][0])*xim_m[i][9]*1.2E1-cos(xim_m[i][0]-xim_m[i][1]*2.0-xim_m[i][2]*2.0)*xim_m[i][8]+cos(xim_m[i][0]*2.0+xim_m[i][1]*2.0)*xim_m[i][5]+cos(xim_m[i][1]*2.0+xim_m[i][2]*2.0)*xim_m[i][5]*2.0+sin(xim_m[i][0]-xim_m[i][1]*2.0-xim_m[i][2]*2.0)*xim_m[i][9]-xim_m[i][5]*2.3E1,2.0)*5.0)*(2.0/5.0))/(pow(cos(xim_m[i][0]+xim_m[i][1]),2.0)+pow(cos(xim_m[i][0]-xim_m[i][2]),2.0)*2.0-1.3E1)))/(sin(xim_m[i][0])*xim_m[i][5]-sin(xim_m[i][1])*xim_m[i][6])+(sin(xim_m[i][1])*((cos(xim_m[i][0]*2.0+xim_m[i][1])*xim_m[i][9]*2.0+sin(xim_m[i][0]*2.0+xim_m[i][1])*xim_m[i][8]*2.0)/(cos(xim_m[i][0]*2.0+xim_m[i][1]*2.0)+cos(xim_m[i][1]*2.0+xim_m[i][2]*2.0)*2.0-2.3E1)+sin(xim_m[i][0]*2.0+xim_m[i][1]*2.0)*1.0/pow(cos(xim_m[i][0]*2.0+xim_m[i][1]*2.0)+cos(xim_m[i][1]*2.0+xim_m[i][2]*2.0)*2.0-2.3E1,2.0)*(-cos(xim_m[i][0]*2.0+xim_m[i][1])*xim_m[i][8]-cos(xim_m[i][1]+xim_m[i][2]*2.0)*xim_m[i][8]*2.0+sin(xim_m[i][0]*2.0+xim_m[i][1])*xim_m[i][9]+sin(xim_m[i][1]+xim_m[i][2]*2.0)*xim_m[i][9]*2.0+cos(xim_m[i][1])*xim_m[i][8]*2.3E1+sin(xim_m[i][1])*xim_m[i][9]*2.3E1)*2.0)*xim_m[i][5])/(sin(xim_m[i][0])*xim_m[i][5]-sin(xim_m[i][1])*xim_m[i][6])+(sin(xim_m[i][1])*((cos(xim_m[i][1]+xim_m[i][2]*2.0)*xim_m[i][9]*4.0+sin(xim_m[i][1]+xim_m[i][2]*2.0)*xim_m[i][8]*4.0)/(cos(xim_m[i][0]*2.0+xim_m[i][1]*2.0)+cos(xim_m[i][1]*2.0+xim_m[i][2]*2.0)*2.0-2.3E1)+sin(xim_m[i][1]*2.0+xim_m[i][2]*2.0)*1.0/pow(cos(xim_m[i][0]*2.0+xim_m[i][1]*2.0)+cos(xim_m[i][1]*2.0+xim_m[i][2]*2.0)*2.0-2.3E1,2.0)*(-cos(xim_m[i][0]*2.0+xim_m[i][1])*xim_m[i][8]-cos(xim_m[i][1]+xim_m[i][2]*2.0)*xim_m[i][8]*2.0+sin(xim_m[i][0]*2.0+xim_m[i][1])*xim_m[i][9]+sin(xim_m[i][1]+xim_m[i][2]*2.0)*xim_m[i][9]*2.0+cos(xim_m[i][1])*xim_m[i][8]*2.3E1+sin(xim_m[i][1])*xim_m[i][9]*2.3E1)*4.0)*xim_m[i][7])/(sin(xim_m[i][0])*xim_m[i][5]-sin(xim_m[i][1])*xim_m[i][6]);
	  PI_map(6,2) = (cos(xim_m[i][1]+xim_m[i][2]*2.0)*xim_m[i][9]*4.0+sin(xim_m[i][1]+xim_m[i][2]*2.0)*xim_m[i][8]*4.0)/(cos(xim_m[i][0]*2.0+xim_m[i][1]*2.0)+cos(xim_m[i][1]*2.0+xim_m[i][2]*2.0)*2.0-2.3E1)+sin(xim_m[i][1]*2.0+xim_m[i][2]*2.0)*1.0/pow(cos(xim_m[i][0]*2.0+xim_m[i][1]*2.0)+cos(xim_m[i][1]*2.0+xim_m[i][2]*2.0)*2.0-2.3E1,2.0)*(-cos(xim_m[i][0]*2.0+xim_m[i][1])*xim_m[i][8]-cos(xim_m[i][1]+xim_m[i][2]*2.0)*xim_m[i][8]*2.0+sin(xim_m[i][0]*2.0+xim_m[i][1])*xim_m[i][9]+sin(xim_m[i][1]+xim_m[i][2]*2.0)*xim_m[i][9]*2.0+cos(xim_m[i][1])*xim_m[i][8]*2.3E1+sin(xim_m[i][1])*xim_m[i][9]*2.3E1)*4.0;
	  PI_map(6,4) = (((pow(cos(xim_m[i][0]-xim_m[i][2]),2.0)*2.0-1.3E1)*(sin(xim_m[i][1])*(9.81E2/4.0E1)+uim[1]-sin(xim_m[i][0]+xim_m[i][1])*1.0/pow(cos(xim_m[i][0]*2.0+xim_m[i][1]*2.0)+cos(xim_m[i][1]*2.0+xim_m[i][2]*2.0)*2.0-2.3E1,2.0)*pow(cos(xim_m[i][0]+xim_m[i][1]*2.0)*xim_m[i][8]*-1.2E1+cos(xim_m[i][0]-xim_m[i][2]*2.0)*xim_m[i][8]-sin(xim_m[i][0]+xim_m[i][1]*2.0)*xim_m[i][9]*1.2E1+sin(xim_m[i][0]-xim_m[i][2]*2.0)*xim_m[i][9]+cos(xim_m[i][0])*xim_m[i][8]*1.2E1-sin(xim_m[i][0])*xim_m[i][9]*1.2E1-cos(xim_m[i][0]-xim_m[i][1]*2.0-xim_m[i][2]*2.0)*xim_m[i][8]+cos(xim_m[i][0]*2.0+xim_m[i][1]*2.0)*xim_m[i][5]+cos(xim_m[i][1]*2.0+xim_m[i][2]*2.0)*xim_m[i][5]*2.0+sin(xim_m[i][0]-xim_m[i][1]*2.0-xim_m[i][2]*2.0)*xim_m[i][9]-xim_m[i][5]*2.3E1,2.0)*(5.0/2.0))*(2.0/5.0))/(pow(cos(xim_m[i][0]+xim_m[i][1]),2.0)+pow(cos(xim_m[i][0]-xim_m[i][2]),2.0)*2.0-1.3E1)-(cos(xim_m[i][0]+xim_m[i][1])*(sin(xim_m[i][0])*3.18825E2+uim[0]+sin(xim_m[i][0]+xim_m[i][1])*1.0/pow(cos(xim_m[i][0]*2.0+xim_m[i][1]*2.0)+cos(xim_m[i][1]*2.0+xim_m[i][2]*2.0)*2.0-2.3E1,2.0)*pow(-cos(xim_m[i][0]*2.0+xim_m[i][1])*xim_m[i][8]-cos(xim_m[i][1]+xim_m[i][2]*2.0)*xim_m[i][8]*2.0+sin(xim_m[i][0]*2.0+xim_m[i][1])*xim_m[i][9]+sin(xim_m[i][1]+xim_m[i][2]*2.0)*xim_m[i][9]*2.0+cos(xim_m[i][1])*xim_m[i][8]*2.3E1+sin(xim_m[i][1])*xim_m[i][9]*2.3E1,2.0)*(5.0/2.0)-sin(xim_m[i][0]-xim_m[i][2])*1.0/pow(cos(xim_m[i][0]*2.0+xim_m[i][1]*2.0)*2.0+cos(xim_m[i][1]*2.0+xim_m[i][2]*2.0)*4.0-4.6E1,2.0)*pow(cos(xim_m[i][0]*2.0+xim_m[i][1]*2.0-xim_m[i][2])*xim_m[i][8]+sin(xim_m[i][0]*2.0+xim_m[i][1]*2.0-xim_m[i][2])*xim_m[i][9]+cos(xim_m[i][1]*2.0+xim_m[i][2])*xim_m[i][8]*2.5E1+sin(xim_m[i][1]*2.0+xim_m[i][2])*xim_m[i][9]*2.5E1-cos(xim_m[i][2])*xim_m[i][8]*2.5E1+sin(xim_m[i][2])*xim_m[i][9]*2.5E1+cos(xim_m[i][0]*2.0+xim_m[i][1]*2.0)*xim_m[i][7]*2.0-cos(xim_m[i][0]*2.0-xim_m[i][2])*xim_m[i][8]+cos(xim_m[i][1]*2.0+xim_m[i][2]*2.0)*xim_m[i][7]*4.0+sin(xim_m[i][0]*2.0-xim_m[i][2])*xim_m[i][9]-xim_m[i][7]*4.6E1,2.0)*5.0)*(2.0/5.0))/(pow(cos(xim_m[i][0]+xim_m[i][1]),2.0)+pow(cos(xim_m[i][0]-xim_m[i][2]),2.0)*2.0-1.3E1)+(cos(xim_m[i][0]-xim_m[i][2])*cos(xim_m[i][0]+xim_m[i][1])*(sin(xim_m[i][2])*(9.81E2/2.0E1)-uim[0]-uim[1]+sin(xim_m[i][0]-xim_m[i][2])*1.0/pow(cos(xim_m[i][0]*2.0+xim_m[i][1]*2.0)+cos(xim_m[i][1]*2.0+xim_m[i][2]*2.0)*2.0-2.3E1,2.0)*pow(cos(xim_m[i][0]+xim_m[i][1]*2.0)*xim_m[i][8]*-1.2E1+cos(xim_m[i][0]-xim_m[i][2]*2.0)*xim_m[i][8]-sin(xim_m[i][0]+xim_m[i][1]*2.0)*xim_m[i][9]*1.2E1+sin(xim_m[i][0]-xim_m[i][2]*2.0)*xim_m[i][9]+cos(xim_m[i][0])*xim_m[i][8]*1.2E1-sin(xim_m[i][0])*xim_m[i][9]*1.2E1-cos(xim_m[i][0]-xim_m[i][1]*2.0-xim_m[i][2]*2.0)*xim_m[i][8]+cos(xim_m[i][0]*2.0+xim_m[i][1]*2.0)*xim_m[i][5]+cos(xim_m[i][1]*2.0+xim_m[i][2]*2.0)*xim_m[i][5]*2.0+sin(xim_m[i][0]-xim_m[i][1]*2.0-xim_m[i][2]*2.0)*xim_m[i][9]-xim_m[i][5]*2.3E1,2.0)*5.0)*(2.0/5.0))/(pow(cos(xim_m[i][0]+xim_m[i][1]),2.0)+pow(cos(xim_m[i][0]-xim_m[i][2]),2.0)*2.0-1.3E1))/(sin(xim_m[i][0])*xim_m[i][5]-sin(xim_m[i][1])*xim_m[i][6])+(((cos(xim_m[i][0]*2.0+xim_m[i][1])*xim_m[i][9]*2.0+sin(xim_m[i][0]*2.0+xim_m[i][1])*xim_m[i][8]*2.0)/(cos(xim_m[i][0]*2.0+xim_m[i][1]*2.0)+cos(xim_m[i][1]*2.0+xim_m[i][2]*2.0)*2.0-2.3E1)+sin(xim_m[i][0]*2.0+xim_m[i][1]*2.0)*1.0/pow(cos(xim_m[i][0]*2.0+xim_m[i][1]*2.0)+cos(xim_m[i][1]*2.0+xim_m[i][2]*2.0)*2.0-2.3E1,2.0)*(-cos(xim_m[i][0]*2.0+xim_m[i][1])*xim_m[i][8]-cos(xim_m[i][1]+xim_m[i][2]*2.0)*xim_m[i][8]*2.0+sin(xim_m[i][0]*2.0+xim_m[i][1])*xim_m[i][9]+sin(xim_m[i][1]+xim_m[i][2]*2.0)*xim_m[i][9]*2.0+cos(xim_m[i][1])*xim_m[i][8]*2.3E1+sin(xim_m[i][1])*xim_m[i][9]*2.3E1)*2.0)*xim_m[i][5])/(sin(xim_m[i][0])*xim_m[i][5]-sin(xim_m[i][1])*xim_m[i][6])+(((cos(xim_m[i][1]+xim_m[i][2]*2.0)*xim_m[i][9]*4.0+sin(xim_m[i][1]+xim_m[i][2]*2.0)*xim_m[i][8]*4.0)/(cos(xim_m[i][0]*2.0+xim_m[i][1]*2.0)+cos(xim_m[i][1]*2.0+xim_m[i][2]*2.0)*2.0-2.3E1)+sin(xim_m[i][1]*2.0+xim_m[i][2]*2.0)*1.0/pow(cos(xim_m[i][0]*2.0+xim_m[i][1]*2.0)+cos(xim_m[i][1]*2.0+xim_m[i][2]*2.0)*2.0-2.3E1,2.0)*(-cos(xim_m[i][0]*2.0+xim_m[i][1])*xim_m[i][8]-cos(xim_m[i][1]+xim_m[i][2]*2.0)*xim_m[i][8]*2.0+sin(xim_m[i][0]*2.0+xim_m[i][1])*xim_m[i][9]+sin(xim_m[i][1]+xim_m[i][2]*2.0)*xim_m[i][9]*2.0+cos(xim_m[i][1])*xim_m[i][8]*2.3E1+sin(xim_m[i][1])*xim_m[i][9]*2.3E1)*4.0)*xim_m[i][7])/(sin(xim_m[i][0])*xim_m[i][5]-sin(xim_m[i][1])*xim_m[i][6])+(((cos(xim_m[i][0]*2.0+xim_m[i][1])*xim_m[i][9]+cos(xim_m[i][1]+xim_m[i][2]*2.0)*xim_m[i][9]*2.0+sin(xim_m[i][0]*2.0+xim_m[i][1])*xim_m[i][8]+sin(xim_m[i][1]+xim_m[i][2]*2.0)*xim_m[i][8]*2.0+cos(xim_m[i][1])*xim_m[i][9]*2.3E1-sin(xim_m[i][1])*xim_m[i][8]*2.3E1)/(cos(xim_m[i][0]*2.0+xim_m[i][1]*2.0)+cos(xim_m[i][1]*2.0+xim_m[i][2]*2.0)*2.0-2.3E1)+(sin(xim_m[i][0]*2.0+xim_m[i][1]*2.0)*2.0+sin(xim_m[i][1]*2.0+xim_m[i][2]*2.0)*4.0)*1.0/pow(cos(xim_m[i][0]*2.0+xim_m[i][1]*2.0)+cos(xim_m[i][1]*2.0+xim_m[i][2]*2.0)*2.0-2.3E1,2.0)*(-cos(xim_m[i][0]*2.0+xim_m[i][1])*xim_m[i][8]-cos(xim_m[i][1]+xim_m[i][2]*2.0)*xim_m[i][8]*2.0+sin(xim_m[i][0]*2.0+xim_m[i][1])*xim_m[i][9]+sin(xim_m[i][1]+xim_m[i][2]*2.0)*xim_m[i][9]*2.0+cos(xim_m[i][1])*xim_m[i][8]*2.3E1+sin(xim_m[i][1])*xim_m[i][9]*2.3E1))*xim_m[i][6])/(sin(xim_m[i][0])*xim_m[i][5]-sin(xim_m[i][1])*xim_m[i][6]);
	  PI_map(6,8) = -(cos(xim_m[i][0]*2.0+xim_m[i][1])+cos(xim_m[i][1]+xim_m[i][2]*2.0)*2.0-cos(xim_m[i][1])*2.3E1)/(cos(xim_m[i][0]*2.0+xim_m[i][1]*2.0)+cos(xim_m[i][1]*2.0+xim_m[i][2]*2.0)*2.0-2.3E1);
	  PI_map(6,9) = (sin(xim_m[i][0]*2.0+xim_m[i][1])+sin(xim_m[i][1]+xim_m[i][2]*2.0)*2.0+sin(xim_m[i][1])*2.3E1)/(cos(xim_m[i][0]*2.0+xim_m[i][1]*2.0)+cos(xim_m[i][1]*2.0+xim_m[i][2]*2.0)*2.0-2.3E1);
	  PI_map(7,0) = (cos(xim_m[i][0]*2.0+xim_m[i][1]*2.0-xim_m[i][2])*xim_m[i][9]-sin(xim_m[i][0]*2.0+xim_m[i][1]*2.0-xim_m[i][2])*xim_m[i][8]+cos(xim_m[i][0]*2.0-xim_m[i][2])*xim_m[i][9]-sin(xim_m[i][0]*2.0+xim_m[i][1]*2.0)*xim_m[i][7]*2.0+sin(xim_m[i][0]*2.0-xim_m[i][2])*xim_m[i][8])/(cos(xim_m[i][0]*2.0+xim_m[i][1]*2.0)+cos(xim_m[i][1]*2.0+xim_m[i][2]*2.0)*2.0-2.3E1)+sin(xim_m[i][0]*2.0+xim_m[i][1]*2.0)*1.0/pow(cos(xim_m[i][0]*2.0+xim_m[i][1]*2.0)+cos(xim_m[i][1]*2.0+xim_m[i][2]*2.0)*2.0-2.3E1,2.0)*(cos(xim_m[i][0]*2.0+xim_m[i][1]*2.0-xim_m[i][2])*xim_m[i][8]+sin(xim_m[i][0]*2.0+xim_m[i][1]*2.0-xim_m[i][2])*xim_m[i][9]+cos(xim_m[i][1]*2.0+xim_m[i][2])*xim_m[i][8]*2.5E1+sin(xim_m[i][1]*2.0+xim_m[i][2])*xim_m[i][9]*2.5E1-cos(xim_m[i][2])*xim_m[i][8]*2.5E1+sin(xim_m[i][2])*xim_m[i][9]*2.5E1+cos(xim_m[i][0]*2.0+xim_m[i][1]*2.0)*xim_m[i][7]*2.0-cos(xim_m[i][0]*2.0-xim_m[i][2])*xim_m[i][8]+cos(xim_m[i][1]*2.0+xim_m[i][2]*2.0)*xim_m[i][7]*4.0+sin(xim_m[i][0]*2.0-xim_m[i][2])*xim_m[i][9]-xim_m[i][7]*4.6E1);
	  PI_map(7,1) = -((-cos(xim_m[i][0]*2.0+xim_m[i][1]*2.0-xim_m[i][2])*xim_m[i][9]+sin(xim_m[i][0]*2.0+xim_m[i][1]*2.0-xim_m[i][2])*xim_m[i][8]-cos(xim_m[i][1]*2.0+xim_m[i][2])*xim_m[i][9]*2.5E1+sin(xim_m[i][1]*2.0+xim_m[i][2])*xim_m[i][8]*2.5E1+sin(xim_m[i][0]*2.0+xim_m[i][1]*2.0)*xim_m[i][7]*2.0+sin(xim_m[i][1]*2.0+xim_m[i][2]*2.0)*xim_m[i][7]*4.0)/(cos(xim_m[i][0]*2.0+xim_m[i][1]*2.0)+cos(xim_m[i][1]*2.0+xim_m[i][2]*2.0)*2.0-2.3E1)-(sin(xim_m[i][0]*2.0+xim_m[i][1]*2.0)*4.0+sin(xim_m[i][1]*2.0+xim_m[i][2]*2.0)*8.0)*1.0/pow(cos(xim_m[i][0]*2.0+xim_m[i][1]*2.0)+cos(xim_m[i][1]*2.0+xim_m[i][2]*2.0)*2.0-2.3E1,2.0)*(cos(xim_m[i][0]*2.0+xim_m[i][1]*2.0-xim_m[i][2])*xim_m[i][8]+sin(xim_m[i][0]*2.0+xim_m[i][1]*2.0-xim_m[i][2])*xim_m[i][9]+cos(xim_m[i][1]*2.0+xim_m[i][2])*xim_m[i][8]*2.5E1+sin(xim_m[i][1]*2.0+xim_m[i][2])*xim_m[i][9]*2.5E1-cos(xim_m[i][2])*xim_m[i][8]*2.5E1+sin(xim_m[i][2])*xim_m[i][9]*2.5E1+cos(xim_m[i][0]*2.0+xim_m[i][1]*2.0)*xim_m[i][7]*2.0-cos(xim_m[i][0]*2.0-xim_m[i][2])*xim_m[i][8]+cos(xim_m[i][1]*2.0+xim_m[i][2]*2.0)*xim_m[i][7]*4.0+sin(xim_m[i][0]*2.0-xim_m[i][2])*xim_m[i][9]-xim_m[i][7]*4.6E1)*(1.0/4.0))*((sin(xim_m[i][1])*xim_m[i][6])/(sin(xim_m[i][0])*xim_m[i][5]-sin(xim_m[i][1])*xim_m[i][6])+1.0)+(sin(xim_m[i][1])*(((pow(cos(xim_m[i][0]+xim_m[i][1]),2.0)-1.3E1)*(sin(xim_m[i][2])*(9.81E2/2.0E1)-uim[0]-uim[1]+sin(xim_m[i][0]-xim_m[i][2])*(xim_m[i][5]*xim_m[i][5])*5.0)*(1.0/5.0))/(pow(cos(xim_m[i][0]+xim_m[i][1]),2.0)+pow(cos(xim_m[i][0]-xim_m[i][2]),2.0)*2.0-1.3E1)+(cos(xim_m[i][0]-xim_m[i][2])*(sin(xim_m[i][0])*3.18825E2+sin(xim_m[i][0]+xim_m[i][1])*(xim_m[i][6]*xim_m[i][6])*(5.0/2.0)+uim[0]-sin(xim_m[i][0]-xim_m[i][2])*(xim_m[i][7]*xim_m[i][7])*5.0)*(2.0/5.0))/(pow(cos(xim_m[i][0]+xim_m[i][1]),2.0)+pow(cos(xim_m[i][0]-xim_m[i][2]),2.0)*2.0-1.3E1)+(cos(xim_m[i][0]-xim_m[i][2])*cos(xim_m[i][0]+xim_m[i][1])*(sin(xim_m[i][1])*(9.81E2/4.0E1)-sin(xim_m[i][0]+xim_m[i][1])*(xim_m[i][5]*xim_m[i][5])*(5.0/2.0)+uim[1])*(2.0/5.0))/(pow(cos(xim_m[i][0]+xim_m[i][1]),2.0)+pow(cos(xim_m[i][0]-xim_m[i][2]),2.0)*2.0-1.3E1)))/(sin(xim_m[i][0])*xim_m[i][5]-sin(xim_m[i][1])*xim_m[i][6])-(sin(xim_m[i][1])*((cos(xim_m[i][0]-xim_m[i][2])*(sin(xim_m[i][0])*3.18825E2+uim[0]+sin(xim_m[i][0]+xim_m[i][1])*1.0/pow(cos(xim_m[i][0]*2.0+xim_m[i][1]*2.0)+cos(xim_m[i][1]*2.0+xim_m[i][2]*2.0)*2.0-2.3E1,2.0)*pow(-cos(xim_m[i][0]*2.0+xim_m[i][1])*xim_m[i][8]-cos(xim_m[i][1]+xim_m[i][2]*2.0)*xim_m[i][8]*2.0+sin(xim_m[i][0]*2.0+xim_m[i][1])*xim_m[i][9]+sin(xim_m[i][1]+xim_m[i][2]*2.0)*xim_m[i][9]*2.0+cos(xim_m[i][1])*xim_m[i][8]*2.3E1+sin(xim_m[i][1])*xim_m[i][9]*2.3E1,2.0)*(5.0/2.0)-sin(xim_m[i][0]-xim_m[i][2])*1.0/pow(cos(xim_m[i][0]*2.0+xim_m[i][1]*2.0)*2.0+cos(xim_m[i][1]*2.0+xim_m[i][2]*2.0)*4.0-4.6E1,2.0)*pow(cos(xim_m[i][0]*2.0+xim_m[i][1]*2.0-xim_m[i][2])*xim_m[i][8]+sin(xim_m[i][0]*2.0+xim_m[i][1]*2.0-xim_m[i][2])*xim_m[i][9]+cos(xim_m[i][1]*2.0+xim_m[i][2])*xim_m[i][8]*2.5E1+sin(xim_m[i][1]*2.0+xim_m[i][2])*xim_m[i][9]*2.5E1-cos(xim_m[i][2])*xim_m[i][8]*2.5E1+sin(xim_m[i][2])*xim_m[i][9]*2.5E1+cos(xim_m[i][0]*2.0+xim_m[i][1]*2.0)*xim_m[i][7]*2.0-cos(xim_m[i][0]*2.0-xim_m[i][2])*xim_m[i][8]+cos(xim_m[i][1]*2.0+xim_m[i][2]*2.0)*xim_m[i][7]*4.0+sin(xim_m[i][0]*2.0-xim_m[i][2])*xim_m[i][9]-xim_m[i][7]*4.6E1,2.0)*5.0)*(2.0/5.0))/(pow(cos(xim_m[i][0]+xim_m[i][1]),2.0)+pow(cos(xim_m[i][0]-xim_m[i][2]),2.0)*2.0-1.3E1)+((pow(cos(xim_m[i][0]+xim_m[i][1]),2.0)-1.3E1)*(sin(xim_m[i][2])*(9.81E2/2.0E1)-uim[0]-uim[1]+sin(xim_m[i][0]-xim_m[i][2])*1.0/pow(cos(xim_m[i][0]*2.0+xim_m[i][1]*2.0)+cos(xim_m[i][1]*2.0+xim_m[i][2]*2.0)*2.0-2.3E1,2.0)*pow(cos(xim_m[i][0]+xim_m[i][1]*2.0)*xim_m[i][8]*-1.2E1+cos(xim_m[i][0]-xim_m[i][2]*2.0)*xim_m[i][8]-sin(xim_m[i][0]+xim_m[i][1]*2.0)*xim_m[i][9]*1.2E1+sin(xim_m[i][0]-xim_m[i][2]*2.0)*xim_m[i][9]+cos(xim_m[i][0])*xim_m[i][8]*1.2E1-sin(xim_m[i][0])*xim_m[i][9]*1.2E1-cos(xim_m[i][0]-xim_m[i][1]*2.0-xim_m[i][2]*2.0)*xim_m[i][8]+cos(xim_m[i][0]*2.0+xim_m[i][1]*2.0)*xim_m[i][5]+cos(xim_m[i][1]*2.0+xim_m[i][2]*2.0)*xim_m[i][5]*2.0+sin(xim_m[i][0]-xim_m[i][1]*2.0-xim_m[i][2]*2.0)*xim_m[i][9]-xim_m[i][5]*2.3E1,2.0)*5.0)*(1.0/5.0))/(pow(cos(xim_m[i][0]+xim_m[i][1]),2.0)+pow(cos(xim_m[i][0]-xim_m[i][2]),2.0)*2.0-1.3E1)+(cos(xim_m[i][0]-xim_m[i][2])*cos(xim_m[i][0]+xim_m[i][1])*(sin(xim_m[i][1])*(9.81E2/4.0E1)+uim[1]-sin(xim_m[i][0]+xim_m[i][1])*1.0/pow(cos(xim_m[i][0]*2.0+xim_m[i][1]*2.0)+cos(xim_m[i][1]*2.0+xim_m[i][2]*2.0)*2.0-2.3E1,2.0)*pow(cos(xim_m[i][0]+xim_m[i][1]*2.0)*xim_m[i][8]*-1.2E1+cos(xim_m[i][0]-xim_m[i][2]*2.0)*xim_m[i][8]-sin(xim_m[i][0]+xim_m[i][1]*2.0)*xim_m[i][9]*1.2E1+sin(xim_m[i][0]-xim_m[i][2]*2.0)*xim_m[i][9]+cos(xim_m[i][0])*xim_m[i][8]*1.2E1-sin(xim_m[i][0])*xim_m[i][9]*1.2E1-cos(xim_m[i][0]-xim_m[i][1]*2.0-xim_m[i][2]*2.0)*xim_m[i][8]+cos(xim_m[i][0]*2.0+xim_m[i][1]*2.0)*xim_m[i][5]+cos(xim_m[i][1]*2.0+xim_m[i][2]*2.0)*xim_m[i][5]*2.0+sin(xim_m[i][0]-xim_m[i][1]*2.0-xim_m[i][2]*2.0)*xim_m[i][9]-xim_m[i][5]*2.3E1,2.0)*(5.0/2.0))*(2.0/5.0))/(pow(cos(xim_m[i][0]+xim_m[i][1]),2.0)+pow(cos(xim_m[i][0]-xim_m[i][2]),2.0)*2.0-1.3E1)))/(sin(xim_m[i][0])*xim_m[i][5]-sin(xim_m[i][1])*xim_m[i][6])+(sin(xim_m[i][1])*((cos(xim_m[i][0]*2.0+xim_m[i][1]*2.0-xim_m[i][2])*xim_m[i][9]-sin(xim_m[i][0]*2.0+xim_m[i][1]*2.0-xim_m[i][2])*xim_m[i][8]+cos(xim_m[i][0]*2.0-xim_m[i][2])*xim_m[i][9]-sin(xim_m[i][0]*2.0+xim_m[i][1]*2.0)*xim_m[i][7]*2.0+sin(xim_m[i][0]*2.0-xim_m[i][2])*xim_m[i][8])/(cos(xim_m[i][0]*2.0+xim_m[i][1]*2.0)+cos(xim_m[i][1]*2.0+xim_m[i][2]*2.0)*2.0-2.3E1)+sin(xim_m[i][0]*2.0+xim_m[i][1]*2.0)*1.0/pow(cos(xim_m[i][0]*2.0+xim_m[i][1]*2.0)+cos(xim_m[i][1]*2.0+xim_m[i][2]*2.0)*2.0-2.3E1,2.0)*(cos(xim_m[i][0]*2.0+xim_m[i][1]*2.0-xim_m[i][2])*xim_m[i][8]+sin(xim_m[i][0]*2.0+xim_m[i][1]*2.0-xim_m[i][2])*xim_m[i][9]+cos(xim_m[i][1]*2.0+xim_m[i][2])*xim_m[i][8]*2.5E1+sin(xim_m[i][1]*2.0+xim_m[i][2])*xim_m[i][9]*2.5E1-cos(xim_m[i][2])*xim_m[i][8]*2.5E1+sin(xim_m[i][2])*xim_m[i][9]*2.5E1+cos(xim_m[i][0]*2.0+xim_m[i][1]*2.0)*xim_m[i][7]*2.0-cos(xim_m[i][0]*2.0-xim_m[i][2])*xim_m[i][8]+cos(xim_m[i][1]*2.0+xim_m[i][2]*2.0)*xim_m[i][7]*4.0+sin(xim_m[i][0]*2.0-xim_m[i][2])*xim_m[i][9]-xim_m[i][7]*4.6E1))*xim_m[i][5])/(sin(xim_m[i][0])*xim_m[i][5]-sin(xim_m[i][1])*xim_m[i][6])-(sin(xim_m[i][1])*((cos(xim_m[i][0]*2.0+xim_m[i][1]*2.0-xim_m[i][2])*xim_m[i][9]-sin(xim_m[i][0]*2.0+xim_m[i][1]*2.0-xim_m[i][2])*xim_m[i][8]-cos(xim_m[i][1]*2.0+xim_m[i][2])*xim_m[i][9]*2.5E1+sin(xim_m[i][1]*2.0+xim_m[i][2])*xim_m[i][8]*2.5E1-cos(xim_m[i][2])*xim_m[i][9]*2.5E1-sin(xim_m[i][2])*xim_m[i][8]*2.5E1+cos(xim_m[i][0]*2.0-xim_m[i][2])*xim_m[i][9]+sin(xim_m[i][0]*2.0-xim_m[i][2])*xim_m[i][8]+sin(xim_m[i][1]*2.0+xim_m[i][2]*2.0)*xim_m[i][7]*8.0)/(cos(xim_m[i][0]*2.0+xim_m[i][1]*2.0)*2.0+cos(xim_m[i][1]*2.0+xim_m[i][2]*2.0)*4.0-4.6E1)-sin(xim_m[i][1]*2.0+xim_m[i][2]*2.0)*1.0/pow(cos(xim_m[i][0]*2.0+xim_m[i][1]*2.0)+cos(xim_m[i][1]*2.0+xim_m[i][2]*2.0)*2.0-2.3E1,2.0)*(cos(xim_m[i][0]*2.0+xim_m[i][1]*2.0-xim_m[i][2])*xim_m[i][8]+sin(xim_m[i][0]*2.0+xim_m[i][1]*2.0-xim_m[i][2])*xim_m[i][9]+cos(xim_m[i][1]*2.0+xim_m[i][2])*xim_m[i][8]*2.5E1+sin(xim_m[i][1]*2.0+xim_m[i][2])*xim_m[i][9]*2.5E1-cos(xim_m[i][2])*xim_m[i][8]*2.5E1+sin(xim_m[i][2])*xim_m[i][9]*2.5E1+cos(xim_m[i][0]*2.0+xim_m[i][1]*2.0)*xim_m[i][7]*2.0-cos(xim_m[i][0]*2.0-xim_m[i][2])*xim_m[i][8]+cos(xim_m[i][1]*2.0+xim_m[i][2]*2.0)*xim_m[i][7]*4.0+sin(xim_m[i][0]*2.0-xim_m[i][2])*xim_m[i][9]-xim_m[i][7]*4.6E1)*2.0)*xim_m[i][7])/(sin(xim_m[i][0])*xim_m[i][5]-sin(xim_m[i][1])*xim_m[i][6]);
	  PI_map(7,2) = -(cos(xim_m[i][0]*2.0+xim_m[i][1]*2.0-xim_m[i][2])*xim_m[i][9]-sin(xim_m[i][0]*2.0+xim_m[i][1]*2.0-xim_m[i][2])*xim_m[i][8]-cos(xim_m[i][1]*2.0+xim_m[i][2])*xim_m[i][9]*2.5E1+sin(xim_m[i][1]*2.0+xim_m[i][2])*xim_m[i][8]*2.5E1-cos(xim_m[i][2])*xim_m[i][9]*2.5E1-sin(xim_m[i][2])*xim_m[i][8]*2.5E1+cos(xim_m[i][0]*2.0-xim_m[i][2])*xim_m[i][9]+sin(xim_m[i][0]*2.0-xim_m[i][2])*xim_m[i][8]+sin(xim_m[i][1]*2.0+xim_m[i][2]*2.0)*xim_m[i][7]*8.0)/(cos(xim_m[i][0]*2.0+xim_m[i][1]*2.0)*2.0+cos(xim_m[i][1]*2.0+xim_m[i][2]*2.0)*4.0-4.6E1)+sin(xim_m[i][1]*2.0+xim_m[i][2]*2.0)*1.0/pow(cos(xim_m[i][0]*2.0+xim_m[i][1]*2.0)+cos(xim_m[i][1]*2.0+xim_m[i][2]*2.0)*2.0-2.3E1,2.0)*(cos(xim_m[i][0]*2.0+xim_m[i][1]*2.0-xim_m[i][2])*xim_m[i][8]+sin(xim_m[i][0]*2.0+xim_m[i][1]*2.0-xim_m[i][2])*xim_m[i][9]+cos(xim_m[i][1]*2.0+xim_m[i][2])*xim_m[i][8]*2.5E1+sin(xim_m[i][1]*2.0+xim_m[i][2])*xim_m[i][9]*2.5E1-cos(xim_m[i][2])*xim_m[i][8]*2.5E1+sin(xim_m[i][2])*xim_m[i][9]*2.5E1+cos(xim_m[i][0]*2.0+xim_m[i][1]*2.0)*xim_m[i][7]*2.0-cos(xim_m[i][0]*2.0-xim_m[i][2])*xim_m[i][8]+cos(xim_m[i][1]*2.0+xim_m[i][2]*2.0)*xim_m[i][7]*4.0+sin(xim_m[i][0]*2.0-xim_m[i][2])*xim_m[i][9]-xim_m[i][7]*4.6E1)*2.0;
	  PI_map(7,4) = -((cos(xim_m[i][0]-xim_m[i][2])*(sin(xim_m[i][0])*3.18825E2+uim[0]+sin(xim_m[i][0]+xim_m[i][1])*1.0/pow(cos(xim_m[i][0]*2.0+xim_m[i][1]*2.0)+cos(xim_m[i][1]*2.0+xim_m[i][2]*2.0)*2.0-2.3E1,2.0)*pow(-cos(xim_m[i][0]*2.0+xim_m[i][1])*xim_m[i][8]-cos(xim_m[i][1]+xim_m[i][2]*2.0)*xim_m[i][8]*2.0+sin(xim_m[i][0]*2.0+xim_m[i][1])*xim_m[i][9]+sin(xim_m[i][1]+xim_m[i][2]*2.0)*xim_m[i][9]*2.0+cos(xim_m[i][1])*xim_m[i][8]*2.3E1+sin(xim_m[i][1])*xim_m[i][9]*2.3E1,2.0)*(5.0/2.0)-sin(xim_m[i][0]-xim_m[i][2])*1.0/pow(cos(xim_m[i][0]*2.0+xim_m[i][1]*2.0)*2.0+cos(xim_m[i][1]*2.0+xim_m[i][2]*2.0)*4.0-4.6E1,2.0)*pow(cos(xim_m[i][0]*2.0+xim_m[i][1]*2.0-xim_m[i][2])*xim_m[i][8]+sin(xim_m[i][0]*2.0+xim_m[i][1]*2.0-xim_m[i][2])*xim_m[i][9]+cos(xim_m[i][1]*2.0+xim_m[i][2])*xim_m[i][8]*2.5E1+sin(xim_m[i][1]*2.0+xim_m[i][2])*xim_m[i][9]*2.5E1-cos(xim_m[i][2])*xim_m[i][8]*2.5E1+sin(xim_m[i][2])*xim_m[i][9]*2.5E1+cos(xim_m[i][0]*2.0+xim_m[i][1]*2.0)*xim_m[i][7]*2.0-cos(xim_m[i][0]*2.0-xim_m[i][2])*xim_m[i][8]+cos(xim_m[i][1]*2.0+xim_m[i][2]*2.0)*xim_m[i][7]*4.0+sin(xim_m[i][0]*2.0-xim_m[i][2])*xim_m[i][9]-xim_m[i][7]*4.6E1,2.0)*5.0)*(2.0/5.0))/(pow(cos(xim_m[i][0]+xim_m[i][1]),2.0)+pow(cos(xim_m[i][0]-xim_m[i][2]),2.0)*2.0-1.3E1)+((pow(cos(xim_m[i][0]+xim_m[i][1]),2.0)-1.3E1)*(sin(xim_m[i][2])*(9.81E2/2.0E1)-uim[0]-uim[1]+sin(xim_m[i][0]-xim_m[i][2])*1.0/pow(cos(xim_m[i][0]*2.0+xim_m[i][1]*2.0)+cos(xim_m[i][1]*2.0+xim_m[i][2]*2.0)*2.0-2.3E1,2.0)*pow(cos(xim_m[i][0]+xim_m[i][1]*2.0)*xim_m[i][8]*-1.2E1+cos(xim_m[i][0]-xim_m[i][2]*2.0)*xim_m[i][8]-sin(xim_m[i][0]+xim_m[i][1]*2.0)*xim_m[i][9]*1.2E1+sin(xim_m[i][0]-xim_m[i][2]*2.0)*xim_m[i][9]+cos(xim_m[i][0])*xim_m[i][8]*1.2E1-sin(xim_m[i][0])*xim_m[i][9]*1.2E1-cos(xim_m[i][0]-xim_m[i][1]*2.0-xim_m[i][2]*2.0)*xim_m[i][8]+cos(xim_m[i][0]*2.0+xim_m[i][1]*2.0)*xim_m[i][5]+cos(xim_m[i][1]*2.0+xim_m[i][2]*2.0)*xim_m[i][5]*2.0+sin(xim_m[i][0]-xim_m[i][1]*2.0-xim_m[i][2]*2.0)*xim_m[i][9]-xim_m[i][5]*2.3E1,2.0)*5.0)*(1.0/5.0))/(pow(cos(xim_m[i][0]+xim_m[i][1]),2.0)+pow(cos(xim_m[i][0]-xim_m[i][2]),2.0)*2.0-1.3E1)+(cos(xim_m[i][0]-xim_m[i][2])*cos(xim_m[i][0]+xim_m[i][1])*(sin(xim_m[i][1])*(9.81E2/4.0E1)+uim[1]-sin(xim_m[i][0]+xim_m[i][1])*1.0/pow(cos(xim_m[i][0]*2.0+xim_m[i][1]*2.0)+cos(xim_m[i][1]*2.0+xim_m[i][2]*2.0)*2.0-2.3E1,2.0)*pow(cos(xim_m[i][0]+xim_m[i][1]*2.0)*xim_m[i][8]*-1.2E1+cos(xim_m[i][0]-xim_m[i][2]*2.0)*xim_m[i][8]-sin(xim_m[i][0]+xim_m[i][1]*2.0)*xim_m[i][9]*1.2E1+sin(xim_m[i][0]-xim_m[i][2]*2.0)*xim_m[i][9]+cos(xim_m[i][0])*xim_m[i][8]*1.2E1-sin(xim_m[i][0])*xim_m[i][9]*1.2E1-cos(xim_m[i][0]-xim_m[i][1]*2.0-xim_m[i][2]*2.0)*xim_m[i][8]+cos(xim_m[i][0]*2.0+xim_m[i][1]*2.0)*xim_m[i][5]+cos(xim_m[i][1]*2.0+xim_m[i][2]*2.0)*xim_m[i][5]*2.0+sin(xim_m[i][0]-xim_m[i][1]*2.0-xim_m[i][2]*2.0)*xim_m[i][9]-xim_m[i][5]*2.3E1,2.0)*(5.0/2.0))*(2.0/5.0))/(pow(cos(xim_m[i][0]+xim_m[i][1]),2.0)+pow(cos(xim_m[i][0]-xim_m[i][2]),2.0)*2.0-1.3E1))/(sin(xim_m[i][0])*xim_m[i][5]-sin(xim_m[i][1])*xim_m[i][6])+(((pow(cos(xim_m[i][0]+xim_m[i][1]),2.0)-1.3E1)*(sin(xim_m[i][2])*(9.81E2/2.0E1)-uim[0]-uim[1]+sin(xim_m[i][0]-xim_m[i][2])*(xim_m[i][5]*xim_m[i][5])*5.0)*(1.0/5.0))/(pow(cos(xim_m[i][0]+xim_m[i][1]),2.0)+pow(cos(xim_m[i][0]-xim_m[i][2]),2.0)*2.0-1.3E1)+(cos(xim_m[i][0]-xim_m[i][2])*(sin(xim_m[i][0])*3.18825E2+sin(xim_m[i][0]+xim_m[i][1])*(xim_m[i][6]*xim_m[i][6])*(5.0/2.0)+uim[0]-sin(xim_m[i][0]-xim_m[i][2])*(xim_m[i][7]*xim_m[i][7])*5.0)*(2.0/5.0))/(pow(cos(xim_m[i][0]+xim_m[i][1]),2.0)+pow(cos(xim_m[i][0]-xim_m[i][2]),2.0)*2.0-1.3E1)+(cos(xim_m[i][0]-xim_m[i][2])*cos(xim_m[i][0]+xim_m[i][1])*(sin(xim_m[i][1])*(9.81E2/4.0E1)-sin(xim_m[i][0]+xim_m[i][1])*(xim_m[i][5]*xim_m[i][5])*(5.0/2.0)+uim[1])*(2.0/5.0))/(pow(cos(xim_m[i][0]+xim_m[i][1]),2.0)+pow(cos(xim_m[i][0]-xim_m[i][2]),2.0)*2.0-1.3E1))/(sin(xim_m[i][0])*xim_m[i][5]-sin(xim_m[i][1])*xim_m[i][6])-(((-cos(xim_m[i][0]*2.0+xim_m[i][1]*2.0-xim_m[i][2])*xim_m[i][9]+sin(xim_m[i][0]*2.0+xim_m[i][1]*2.0-xim_m[i][2])*xim_m[i][8]-cos(xim_m[i][1]*2.0+xim_m[i][2])*xim_m[i][9]*2.5E1+sin(xim_m[i][1]*2.0+xim_m[i][2])*xim_m[i][8]*2.5E1+sin(xim_m[i][0]*2.0+xim_m[i][1]*2.0)*xim_m[i][7]*2.0+sin(xim_m[i][1]*2.0+xim_m[i][2]*2.0)*xim_m[i][7]*4.0)/(cos(xim_m[i][0]*2.0+xim_m[i][1]*2.0)+cos(xim_m[i][1]*2.0+xim_m[i][2]*2.0)*2.0-2.3E1)-(sin(xim_m[i][0]*2.0+xim_m[i][1]*2.0)*4.0+sin(xim_m[i][1]*2.0+xim_m[i][2]*2.0)*8.0)*1.0/pow(cos(xim_m[i][0]*2.0+xim_m[i][1]*2.0)+cos(xim_m[i][1]*2.0+xim_m[i][2]*2.0)*2.0-2.3E1,2.0)*(cos(xim_m[i][0]*2.0+xim_m[i][1]*2.0-xim_m[i][2])*xim_m[i][8]+sin(xim_m[i][0]*2.0+xim_m[i][1]*2.0-xim_m[i][2])*xim_m[i][9]+cos(xim_m[i][1]*2.0+xim_m[i][2])*xim_m[i][8]*2.5E1+sin(xim_m[i][1]*2.0+xim_m[i][2])*xim_m[i][9]*2.5E1-cos(xim_m[i][2])*xim_m[i][8]*2.5E1+sin(xim_m[i][2])*xim_m[i][9]*2.5E1+cos(xim_m[i][0]*2.0+xim_m[i][1]*2.0)*xim_m[i][7]*2.0-cos(xim_m[i][0]*2.0-xim_m[i][2])*xim_m[i][8]+cos(xim_m[i][1]*2.0+xim_m[i][2]*2.0)*xim_m[i][7]*4.0+sin(xim_m[i][0]*2.0-xim_m[i][2])*xim_m[i][9]-xim_m[i][7]*4.6E1)*(1.0/4.0))*xim_m[i][6])/(sin(xim_m[i][0])*xim_m[i][5]-sin(xim_m[i][1])*xim_m[i][6])+(((cos(xim_m[i][0]*2.0+xim_m[i][1]*2.0-xim_m[i][2])*xim_m[i][9]-sin(xim_m[i][0]*2.0+xim_m[i][1]*2.0-xim_m[i][2])*xim_m[i][8]+cos(xim_m[i][0]*2.0-xim_m[i][2])*xim_m[i][9]-sin(xim_m[i][0]*2.0+xim_m[i][1]*2.0)*xim_m[i][7]*2.0+sin(xim_m[i][0]*2.0-xim_m[i][2])*xim_m[i][8])/(cos(xim_m[i][0]*2.0+xim_m[i][1]*2.0)+cos(xim_m[i][1]*2.0+xim_m[i][2]*2.0)*2.0-2.3E1)+sin(xim_m[i][0]*2.0+xim_m[i][1]*2.0)*1.0/pow(cos(xim_m[i][0]*2.0+xim_m[i][1]*2.0)+cos(xim_m[i][1]*2.0+xim_m[i][2]*2.0)*2.0-2.3E1,2.0)*(cos(xim_m[i][0]*2.0+xim_m[i][1]*2.0-xim_m[i][2])*xim_m[i][8]+sin(xim_m[i][0]*2.0+xim_m[i][1]*2.0-xim_m[i][2])*xim_m[i][9]+cos(xim_m[i][1]*2.0+xim_m[i][2])*xim_m[i][8]*2.5E1+sin(xim_m[i][1]*2.0+xim_m[i][2])*xim_m[i][9]*2.5E1-cos(xim_m[i][2])*xim_m[i][8]*2.5E1+sin(xim_m[i][2])*xim_m[i][9]*2.5E1+cos(xim_m[i][0]*2.0+xim_m[i][1]*2.0)*xim_m[i][7]*2.0-cos(xim_m[i][0]*2.0-xim_m[i][2])*xim_m[i][8]+cos(xim_m[i][1]*2.0+xim_m[i][2]*2.0)*xim_m[i][7]*4.0+sin(xim_m[i][0]*2.0-xim_m[i][2])*xim_m[i][9]-xim_m[i][7]*4.6E1))*xim_m[i][5])/(sin(xim_m[i][0])*xim_m[i][5]-sin(xim_m[i][1])*xim_m[i][6])-(((cos(xim_m[i][0]*2.0+xim_m[i][1]*2.0-xim_m[i][2])*xim_m[i][9]-sin(xim_m[i][0]*2.0+xim_m[i][1]*2.0-xim_m[i][2])*xim_m[i][8]-cos(xim_m[i][1]*2.0+xim_m[i][2])*xim_m[i][9]*2.5E1+sin(xim_m[i][1]*2.0+xim_m[i][2])*xim_m[i][8]*2.5E1-cos(xim_m[i][2])*xim_m[i][9]*2.5E1-sin(xim_m[i][2])*xim_m[i][8]*2.5E1+cos(xim_m[i][0]*2.0-xim_m[i][2])*xim_m[i][9]+sin(xim_m[i][0]*2.0-xim_m[i][2])*xim_m[i][8]+sin(xim_m[i][1]*2.0+xim_m[i][2]*2.0)*xim_m[i][7]*8.0)/(cos(xim_m[i][0]*2.0+xim_m[i][1]*2.0)*2.0+cos(xim_m[i][1]*2.0+xim_m[i][2]*2.0)*4.0-4.6E1)-sin(xim_m[i][1]*2.0+xim_m[i][2]*2.0)*1.0/pow(cos(xim_m[i][0]*2.0+xim_m[i][1]*2.0)+cos(xim_m[i][1]*2.0+xim_m[i][2]*2.0)*2.0-2.3E1,2.0)*(cos(xim_m[i][0]*2.0+xim_m[i][1]*2.0-xim_m[i][2])*xim_m[i][8]+sin(xim_m[i][0]*2.0+xim_m[i][1]*2.0-xim_m[i][2])*xim_m[i][9]+cos(xim_m[i][1]*2.0+xim_m[i][2])*xim_m[i][8]*2.5E1+sin(xim_m[i][1]*2.0+xim_m[i][2])*xim_m[i][9]*2.5E1-cos(xim_m[i][2])*xim_m[i][8]*2.5E1+sin(xim_m[i][2])*xim_m[i][9]*2.5E1+cos(xim_m[i][0]*2.0+xim_m[i][1]*2.0)*xim_m[i][7]*2.0-cos(xim_m[i][0]*2.0-xim_m[i][2])*xim_m[i][8]+cos(xim_m[i][1]*2.0+xim_m[i][2]*2.0)*xim_m[i][7]*4.0+sin(xim_m[i][0]*2.0-xim_m[i][2])*xim_m[i][9]-xim_m[i][7]*4.6E1)*2.0)*xim_m[i][7])/(sin(xim_m[i][0])*xim_m[i][5]-sin(xim_m[i][1])*xim_m[i][6]);
	  PI_map(7,7) = 1.0;
	  PI_map(7,8) = (cos(xim_m[i][1]*2.0+xim_m[i][2])*2.5E1-cos(xim_m[i][2])*2.5E1-cos(xim_m[i][0]*2.0-xim_m[i][2])+cos(xim_m[i][0]*2.0+xim_m[i][1]*2.0-xim_m[i][2]))/(cos(xim_m[i][0]*2.0+xim_m[i][1]*2.0)*2.0+cos(xim_m[i][1]*2.0+xim_m[i][2]*2.0)*4.0-4.6E1);
	  PI_map(7,9) = (sin(xim_m[i][1]*2.0+xim_m[i][2])*2.5E1+sin(xim_m[i][2])*2.5E1+sin(xim_m[i][0]*2.0-xim_m[i][2])+sin(xim_m[i][0]*2.0+xim_m[i][1]*2.0-xim_m[i][2]))/(cos(xim_m[i][0]*2.0+xim_m[i][1]*2.0)*2.0+cos(xim_m[i][1]*2.0+xim_m[i][2]*2.0)*4.0-4.6E1);
	  PI_map(8,0) = -(cos(xim_m[i][0]*2.0)*xim_m[i][9]+sin(xim_m[i][0]*2.0)*xim_m[i][8]+cos(xim_m[i][0]*2.0+xim_m[i][1]*2.0)*xim_m[i][9]+sin(xim_m[i][0]*2.0+xim_m[i][1]*2.0)*xim_m[i][8])/(cos(xim_m[i][0]*2.0+xim_m[i][1]*2.0)+cos(xim_m[i][1]*2.0+xim_m[i][2]*2.0)*2.0-2.3E1)-sin(xim_m[i][0]*2.0+xim_m[i][1]*2.0)*1.0/pow(cos(xim_m[i][0]*2.0+xim_m[i][1]*2.0)+cos(xim_m[i][1]*2.0+xim_m[i][2]*2.0)*2.0-2.3E1,2.0)*(-cos(xim_m[i][0]*2.0)*xim_m[i][8]+cos(xim_m[i][1]*2.0)*xim_m[i][8]*2.3E1-cos(xim_m[i][2]*2.0)*xim_m[i][8]*2.0+sin(xim_m[i][0]*2.0)*xim_m[i][9]+sin(xim_m[i][1]*2.0)*xim_m[i][9]*2.3E1+sin(xim_m[i][2]*2.0)*xim_m[i][9]*2.0-cos(xim_m[i][0]*2.0+xim_m[i][1]*2.0)*xim_m[i][8]-cos(xim_m[i][1]*2.0+xim_m[i][2]*2.0)*xim_m[i][8]*2.0+sin(xim_m[i][0]*2.0+xim_m[i][1]*2.0)*xim_m[i][9]+sin(xim_m[i][1]*2.0+xim_m[i][2]*2.0)*xim_m[i][9]*2.0+xim_m[i][8]*2.3E1);
	  PI_map(8,1) = -((cos(xim_m[i][1]*2.0)*xim_m[i][9]*2.3E1-sin(xim_m[i][1]*2.0)*xim_m[i][8]*2.3E1+cos(xim_m[i][0]*2.0+xim_m[i][1]*2.0)*xim_m[i][9]+cos(xim_m[i][1]*2.0+xim_m[i][2]*2.0)*xim_m[i][9]*2.0+sin(xim_m[i][0]*2.0+xim_m[i][1]*2.0)*xim_m[i][8]+sin(xim_m[i][1]*2.0+xim_m[i][2]*2.0)*xim_m[i][8]*2.0)/(cos(xim_m[i][0]*2.0+xim_m[i][1]*2.0)+cos(xim_m[i][1]*2.0+xim_m[i][2]*2.0)*2.0-2.3E1)+(sin(xim_m[i][0]*2.0+xim_m[i][1]*2.0)*4.0+sin(xim_m[i][1]*2.0+xim_m[i][2]*2.0)*8.0)*1.0/pow(cos(xim_m[i][0]*2.0+xim_m[i][1]*2.0)+cos(xim_m[i][1]*2.0+xim_m[i][2]*2.0)*2.0-2.3E1,2.0)*(-cos(xim_m[i][0]*2.0)*xim_m[i][8]+cos(xim_m[i][1]*2.0)*xim_m[i][8]*2.3E1-cos(xim_m[i][2]*2.0)*xim_m[i][8]*2.0+sin(xim_m[i][0]*2.0)*xim_m[i][9]+sin(xim_m[i][1]*2.0)*xim_m[i][9]*2.3E1+sin(xim_m[i][2]*2.0)*xim_m[i][9]*2.0-cos(xim_m[i][0]*2.0+xim_m[i][1]*2.0)*xim_m[i][8]-cos(xim_m[i][1]*2.0+xim_m[i][2]*2.0)*xim_m[i][8]*2.0+sin(xim_m[i][0]*2.0+xim_m[i][1]*2.0)*xim_m[i][9]+sin(xim_m[i][1]*2.0+xim_m[i][2]*2.0)*xim_m[i][9]*2.0+xim_m[i][8]*2.3E1)*(1.0/4.0))*((sin(xim_m[i][1])*xim_m[i][6])/(sin(xim_m[i][0])*xim_m[i][5]-sin(xim_m[i][1])*xim_m[i][6])+1.0)-(sin(xim_m[i][1])*((cos(xim_m[i][0]*2.0)*xim_m[i][9]+sin(xim_m[i][0]*2.0)*xim_m[i][8]+cos(xim_m[i][0]*2.0+xim_m[i][1]*2.0)*xim_m[i][9]+sin(xim_m[i][0]*2.0+xim_m[i][1]*2.0)*xim_m[i][8])/(cos(xim_m[i][0]*2.0+xim_m[i][1]*2.0)+cos(xim_m[i][1]*2.0+xim_m[i][2]*2.0)*2.0-2.3E1)+sin(xim_m[i][0]*2.0+xim_m[i][1]*2.0)*1.0/pow(cos(xim_m[i][0]*2.0+xim_m[i][1]*2.0)+cos(xim_m[i][1]*2.0+xim_m[i][2]*2.0)*2.0-2.3E1,2.0)*(-cos(xim_m[i][0]*2.0)*xim_m[i][8]+cos(xim_m[i][1]*2.0)*xim_m[i][8]*2.3E1-cos(xim_m[i][2]*2.0)*xim_m[i][8]*2.0+sin(xim_m[i][0]*2.0)*xim_m[i][9]+sin(xim_m[i][1]*2.0)*xim_m[i][9]*2.3E1+sin(xim_m[i][2]*2.0)*xim_m[i][9]*2.0-cos(xim_m[i][0]*2.0+xim_m[i][1]*2.0)*xim_m[i][8]-cos(xim_m[i][1]*2.0+xim_m[i][2]*2.0)*xim_m[i][8]*2.0+sin(xim_m[i][0]*2.0+xim_m[i][1]*2.0)*xim_m[i][9]+sin(xim_m[i][1]*2.0+xim_m[i][2]*2.0)*xim_m[i][9]*2.0+xim_m[i][8]*2.3E1))*xim_m[i][5])/(sin(xim_m[i][0])*xim_m[i][5]-sin(xim_m[i][1])*xim_m[i][6])-(sin(xim_m[i][1])*((cos(xim_m[i][2]*2.0)*xim_m[i][9]*2.0+sin(xim_m[i][2]*2.0)*xim_m[i][8]*2.0+cos(xim_m[i][1]*2.0+xim_m[i][2]*2.0)*xim_m[i][9]*2.0+sin(xim_m[i][1]*2.0+xim_m[i][2]*2.0)*xim_m[i][8]*2.0)/(cos(xim_m[i][0]*2.0+xim_m[i][1]*2.0)+cos(xim_m[i][1]*2.0+xim_m[i][2]*2.0)*2.0-2.3E1)+sin(xim_m[i][1]*2.0+xim_m[i][2]*2.0)*1.0/pow(cos(xim_m[i][0]*2.0+xim_m[i][1]*2.0)+cos(xim_m[i][1]*2.0+xim_m[i][2]*2.0)*2.0-2.3E1,2.0)*(-cos(xim_m[i][0]*2.0)*xim_m[i][8]+cos(xim_m[i][1]*2.0)*xim_m[i][8]*2.3E1-cos(xim_m[i][2]*2.0)*xim_m[i][8]*2.0+sin(xim_m[i][0]*2.0)*xim_m[i][9]+sin(xim_m[i][1]*2.0)*xim_m[i][9]*2.3E1+sin(xim_m[i][2]*2.0)*xim_m[i][9]*2.0-cos(xim_m[i][0]*2.0+xim_m[i][1]*2.0)*xim_m[i][8]-cos(xim_m[i][1]*2.0+xim_m[i][2]*2.0)*xim_m[i][8]*2.0+sin(xim_m[i][0]*2.0+xim_m[i][1]*2.0)*xim_m[i][9]+sin(xim_m[i][1]*2.0+xim_m[i][2]*2.0)*xim_m[i][9]*2.0+xim_m[i][8]*2.3E1)*2.0)*xim_m[i][7])/(sin(xim_m[i][0])*xim_m[i][5]-sin(xim_m[i][1])*xim_m[i][6]);
	  PI_map(8,2) = -(cos(xim_m[i][2]*2.0)*xim_m[i][9]*2.0+sin(xim_m[i][2]*2.0)*xim_m[i][8]*2.0+cos(xim_m[i][1]*2.0+xim_m[i][2]*2.0)*xim_m[i][9]*2.0+sin(xim_m[i][1]*2.0+xim_m[i][2]*2.0)*xim_m[i][8]*2.0)/(cos(xim_m[i][0]*2.0+xim_m[i][1]*2.0)+cos(xim_m[i][1]*2.0+xim_m[i][2]*2.0)*2.0-2.3E1)-sin(xim_m[i][1]*2.0+xim_m[i][2]*2.0)*1.0/pow(cos(xim_m[i][0]*2.0+xim_m[i][1]*2.0)+cos(xim_m[i][1]*2.0+xim_m[i][2]*2.0)*2.0-2.3E1,2.0)*(-cos(xim_m[i][0]*2.0)*xim_m[i][8]+cos(xim_m[i][1]*2.0)*xim_m[i][8]*2.3E1-cos(xim_m[i][2]*2.0)*xim_m[i][8]*2.0+sin(xim_m[i][0]*2.0)*xim_m[i][9]+sin(xim_m[i][1]*2.0)*xim_m[i][9]*2.3E1+sin(xim_m[i][2]*2.0)*xim_m[i][9]*2.0-cos(xim_m[i][0]*2.0+xim_m[i][1]*2.0)*xim_m[i][8]-cos(xim_m[i][1]*2.0+xim_m[i][2]*2.0)*xim_m[i][8]*2.0+sin(xim_m[i][0]*2.0+xim_m[i][1]*2.0)*xim_m[i][9]+sin(xim_m[i][1]*2.0+xim_m[i][2]*2.0)*xim_m[i][9]*2.0+xim_m[i][8]*2.3E1)*2.0;
	  PI_map(8,4) = -(((cos(xim_m[i][1]*2.0)*xim_m[i][9]*2.3E1-sin(xim_m[i][1]*2.0)*xim_m[i][8]*2.3E1+cos(xim_m[i][0]*2.0+xim_m[i][1]*2.0)*xim_m[i][9]+cos(xim_m[i][1]*2.0+xim_m[i][2]*2.0)*xim_m[i][9]*2.0+sin(xim_m[i][0]*2.0+xim_m[i][1]*2.0)*xim_m[i][8]+sin(xim_m[i][1]*2.0+xim_m[i][2]*2.0)*xim_m[i][8]*2.0)/(cos(xim_m[i][0]*2.0+xim_m[i][1]*2.0)+cos(xim_m[i][1]*2.0+xim_m[i][2]*2.0)*2.0-2.3E1)+(sin(xim_m[i][0]*2.0+xim_m[i][1]*2.0)*4.0+sin(xim_m[i][1]*2.0+xim_m[i][2]*2.0)*8.0)*1.0/pow(cos(xim_m[i][0]*2.0+xim_m[i][1]*2.0)+cos(xim_m[i][1]*2.0+xim_m[i][2]*2.0)*2.0-2.3E1,2.0)*(-cos(xim_m[i][0]*2.0)*xim_m[i][8]+cos(xim_m[i][1]*2.0)*xim_m[i][8]*2.3E1-cos(xim_m[i][2]*2.0)*xim_m[i][8]*2.0+sin(xim_m[i][0]*2.0)*xim_m[i][9]+sin(xim_m[i][1]*2.0)*xim_m[i][9]*2.3E1+sin(xim_m[i][2]*2.0)*xim_m[i][9]*2.0-cos(xim_m[i][0]*2.0+xim_m[i][1]*2.0)*xim_m[i][8]-cos(xim_m[i][1]*2.0+xim_m[i][2]*2.0)*xim_m[i][8]*2.0+sin(xim_m[i][0]*2.0+xim_m[i][1]*2.0)*xim_m[i][9]+sin(xim_m[i][1]*2.0+xim_m[i][2]*2.0)*xim_m[i][9]*2.0+xim_m[i][8]*2.3E1)*(1.0/4.0))*xim_m[i][6])/(sin(xim_m[i][0])*xim_m[i][5]-sin(xim_m[i][1])*xim_m[i][6])-(((cos(xim_m[i][0]*2.0)*xim_m[i][9]+sin(xim_m[i][0]*2.0)*xim_m[i][8]+cos(xim_m[i][0]*2.0+xim_m[i][1]*2.0)*xim_m[i][9]+sin(xim_m[i][0]*2.0+xim_m[i][1]*2.0)*xim_m[i][8])/(cos(xim_m[i][0]*2.0+xim_m[i][1]*2.0)+cos(xim_m[i][1]*2.0+xim_m[i][2]*2.0)*2.0-2.3E1)+sin(xim_m[i][0]*2.0+xim_m[i][1]*2.0)*1.0/pow(cos(xim_m[i][0]*2.0+xim_m[i][1]*2.0)+cos(xim_m[i][1]*2.0+xim_m[i][2]*2.0)*2.0-2.3E1,2.0)*(-cos(xim_m[i][0]*2.0)*xim_m[i][8]+cos(xim_m[i][1]*2.0)*xim_m[i][8]*2.3E1-cos(xim_m[i][2]*2.0)*xim_m[i][8]*2.0+sin(xim_m[i][0]*2.0)*xim_m[i][9]+sin(xim_m[i][1]*2.0)*xim_m[i][9]*2.3E1+sin(xim_m[i][2]*2.0)*xim_m[i][9]*2.0-cos(xim_m[i][0]*2.0+xim_m[i][1]*2.0)*xim_m[i][8]-cos(xim_m[i][1]*2.0+xim_m[i][2]*2.0)*xim_m[i][8]*2.0+sin(xim_m[i][0]*2.0+xim_m[i][1]*2.0)*xim_m[i][9]+sin(xim_m[i][1]*2.0+xim_m[i][2]*2.0)*xim_m[i][9]*2.0+xim_m[i][8]*2.3E1))*xim_m[i][5])/(sin(xim_m[i][0])*xim_m[i][5]-sin(xim_m[i][1])*xim_m[i][6])-(((cos(xim_m[i][2]*2.0)*xim_m[i][9]*2.0+sin(xim_m[i][2]*2.0)*xim_m[i][8]*2.0+cos(xim_m[i][1]*2.0+xim_m[i][2]*2.0)*xim_m[i][9]*2.0+sin(xim_m[i][1]*2.0+xim_m[i][2]*2.0)*xim_m[i][8]*2.0)/(cos(xim_m[i][0]*2.0+xim_m[i][1]*2.0)+cos(xim_m[i][1]*2.0+xim_m[i][2]*2.0)*2.0-2.3E1)+sin(xim_m[i][1]*2.0+xim_m[i][2]*2.0)*1.0/pow(cos(xim_m[i][0]*2.0+xim_m[i][1]*2.0)+cos(xim_m[i][1]*2.0+xim_m[i][2]*2.0)*2.0-2.3E1,2.0)*(-cos(xim_m[i][0]*2.0)*xim_m[i][8]+cos(xim_m[i][1]*2.0)*xim_m[i][8]*2.3E1-cos(xim_m[i][2]*2.0)*xim_m[i][8]*2.0+sin(xim_m[i][0]*2.0)*xim_m[i][9]+sin(xim_m[i][1]*2.0)*xim_m[i][9]*2.3E1+sin(xim_m[i][2]*2.0)*xim_m[i][9]*2.0-cos(xim_m[i][0]*2.0+xim_m[i][1]*2.0)*xim_m[i][8]-cos(xim_m[i][1]*2.0+xim_m[i][2]*2.0)*xim_m[i][8]*2.0+sin(xim_m[i][0]*2.0+xim_m[i][1]*2.0)*xim_m[i][9]+sin(xim_m[i][1]*2.0+xim_m[i][2]*2.0)*xim_m[i][9]*2.0+xim_m[i][8]*2.3E1)*2.0)*xim_m[i][7])/(sin(xim_m[i][0])*xim_m[i][5]-sin(xim_m[i][1])*xim_m[i][6]);
	  PI_map(8,8) = (cos(xim_m[i][0]*2.0+xim_m[i][1]*2.0)+cos(xim_m[i][1]*2.0+xim_m[i][2]*2.0)*2.0+cos(xim_m[i][0]*2.0)-cos(xim_m[i][1]*2.0)*2.3E1+cos(xim_m[i][2]*2.0)*2.0-2.3E1)/(cos(xim_m[i][0]*2.0+xim_m[i][1]*2.0)*2.0+cos(xim_m[i][1]*2.0+xim_m[i][2]*2.0)*4.0-4.6E1);
	  PI_map(8,9) = -(sin(xim_m[i][0]*2.0+xim_m[i][1]*2.0)+sin(xim_m[i][1]*2.0+xim_m[i][2]*2.0)*2.0+sin(xim_m[i][0]*2.0)+sin(xim_m[i][1]*2.0)*2.3E1+sin(xim_m[i][2]*2.0)*2.0)/(cos(xim_m[i][0]*2.0+xim_m[i][1]*2.0)*2.0+cos(xim_m[i][1]*2.0+xim_m[i][2]*2.0)*4.0-4.6E1);
	  PI_map(9,0) = -(cos(xim_m[i][0]*2.0)*xim_m[i][8]-sin(xim_m[i][0]*2.0)*xim_m[i][9]-cos(xim_m[i][0]*2.0+xim_m[i][1]*2.0)*xim_m[i][8]+sin(xim_m[i][0]*2.0+xim_m[i][1]*2.0)*xim_m[i][9])/(cos(xim_m[i][0]*2.0+xim_m[i][1]*2.0)+cos(xim_m[i][1]*2.0+xim_m[i][2]*2.0)*2.0-2.3E1)-sin(xim_m[i][0]*2.0+xim_m[i][1]*2.0)*1.0/pow(cos(xim_m[i][0]*2.0+xim_m[i][1]*2.0)+cos(xim_m[i][1]*2.0+xim_m[i][2]*2.0)*2.0-2.3E1,2.0)*(cos(xim_m[i][0]*2.0)*xim_m[i][9]-cos(xim_m[i][1]*2.0)*xim_m[i][9]*2.3E1+cos(xim_m[i][2]*2.0)*xim_m[i][9]*2.0+sin(xim_m[i][0]*2.0)*xim_m[i][8]+sin(xim_m[i][1]*2.0)*xim_m[i][8]*2.3E1+sin(xim_m[i][2]*2.0)*xim_m[i][8]*2.0-cos(xim_m[i][0]*2.0+xim_m[i][1]*2.0)*xim_m[i][9]-cos(xim_m[i][1]*2.0+xim_m[i][2]*2.0)*xim_m[i][9]*2.0-sin(xim_m[i][0]*2.0+xim_m[i][1]*2.0)*xim_m[i][8]-sin(xim_m[i][1]*2.0+xim_m[i][2]*2.0)*xim_m[i][8]*2.0+xim_m[i][9]*2.3E1);
	  PI_map(9,1) = -((cos(xim_m[i][1]*2.0)*xim_m[i][8]*2.3E1+sin(xim_m[i][1]*2.0)*xim_m[i][9]*2.3E1-cos(xim_m[i][0]*2.0+xim_m[i][1]*2.0)*xim_m[i][8]-cos(xim_m[i][1]*2.0+xim_m[i][2]*2.0)*xim_m[i][8]*2.0+sin(xim_m[i][0]*2.0+xim_m[i][1]*2.0)*xim_m[i][9]+sin(xim_m[i][1]*2.0+xim_m[i][2]*2.0)*xim_m[i][9]*2.0)/(cos(xim_m[i][0]*2.0+xim_m[i][1]*2.0)+cos(xim_m[i][1]*2.0+xim_m[i][2]*2.0)*2.0-2.3E1)+(sin(xim_m[i][0]*2.0+xim_m[i][1]*2.0)*4.0+sin(xim_m[i][1]*2.0+xim_m[i][2]*2.0)*8.0)*1.0/pow(cos(xim_m[i][0]*2.0+xim_m[i][1]*2.0)+cos(xim_m[i][1]*2.0+xim_m[i][2]*2.0)*2.0-2.3E1,2.0)*(cos(xim_m[i][0]*2.0)*xim_m[i][9]-cos(xim_m[i][1]*2.0)*xim_m[i][9]*2.3E1+cos(xim_m[i][2]*2.0)*xim_m[i][9]*2.0+sin(xim_m[i][0]*2.0)*xim_m[i][8]+sin(xim_m[i][1]*2.0)*xim_m[i][8]*2.3E1+sin(xim_m[i][2]*2.0)*xim_m[i][8]*2.0-cos(xim_m[i][0]*2.0+xim_m[i][1]*2.0)*xim_m[i][9]-cos(xim_m[i][1]*2.0+xim_m[i][2]*2.0)*xim_m[i][9]*2.0-sin(xim_m[i][0]*2.0+xim_m[i][1]*2.0)*xim_m[i][8]-sin(xim_m[i][1]*2.0+xim_m[i][2]*2.0)*xim_m[i][8]*2.0+xim_m[i][9]*2.3E1)*(1.0/4.0))*((sin(xim_m[i][1])*xim_m[i][6])/(sin(xim_m[i][0])*xim_m[i][5]-sin(xim_m[i][1])*xim_m[i][6])+1.0)-(sin(xim_m[i][1])*((cos(xim_m[i][0]*2.0)*xim_m[i][8]-sin(xim_m[i][0]*2.0)*xim_m[i][9]-cos(xim_m[i][0]*2.0+xim_m[i][1]*2.0)*xim_m[i][8]+sin(xim_m[i][0]*2.0+xim_m[i][1]*2.0)*xim_m[i][9])/(cos(xim_m[i][0]*2.0+xim_m[i][1]*2.0)+cos(xim_m[i][1]*2.0+xim_m[i][2]*2.0)*2.0-2.3E1)+sin(xim_m[i][0]*2.0+xim_m[i][1]*2.0)*1.0/pow(cos(xim_m[i][0]*2.0+xim_m[i][1]*2.0)+cos(xim_m[i][1]*2.0+xim_m[i][2]*2.0)*2.0-2.3E1,2.0)*(cos(xim_m[i][0]*2.0)*xim_m[i][9]-cos(xim_m[i][1]*2.0)*xim_m[i][9]*2.3E1+cos(xim_m[i][2]*2.0)*xim_m[i][9]*2.0+sin(xim_m[i][0]*2.0)*xim_m[i][8]+sin(xim_m[i][1]*2.0)*xim_m[i][8]*2.3E1+sin(xim_m[i][2]*2.0)*xim_m[i][8]*2.0-cos(xim_m[i][0]*2.0+xim_m[i][1]*2.0)*xim_m[i][9]-cos(xim_m[i][1]*2.0+xim_m[i][2]*2.0)*xim_m[i][9]*2.0-sin(xim_m[i][0]*2.0+xim_m[i][1]*2.0)*xim_m[i][8]-sin(xim_m[i][1]*2.0+xim_m[i][2]*2.0)*xim_m[i][8]*2.0+xim_m[i][9]*2.3E1))*xim_m[i][5])/(sin(xim_m[i][0])*xim_m[i][5]-sin(xim_m[i][1])*xim_m[i][6])-(sin(xim_m[i][1])*((cos(xim_m[i][2]*2.0)*xim_m[i][8]*2.0-sin(xim_m[i][2]*2.0)*xim_m[i][9]*2.0-cos(xim_m[i][1]*2.0+xim_m[i][2]*2.0)*xim_m[i][8]*2.0+sin(xim_m[i][1]*2.0+xim_m[i][2]*2.0)*xim_m[i][9]*2.0)/(cos(xim_m[i][0]*2.0+xim_m[i][1]*2.0)+cos(xim_m[i][1]*2.0+xim_m[i][2]*2.0)*2.0-2.3E1)+sin(xim_m[i][1]*2.0+xim_m[i][2]*2.0)*1.0/pow(cos(xim_m[i][0]*2.0+xim_m[i][1]*2.0)+cos(xim_m[i][1]*2.0+xim_m[i][2]*2.0)*2.0-2.3E1,2.0)*(cos(xim_m[i][0]*2.0)*xim_m[i][9]-cos(xim_m[i][1]*2.0)*xim_m[i][9]*2.3E1+cos(xim_m[i][2]*2.0)*xim_m[i][9]*2.0+sin(xim_m[i][0]*2.0)*xim_m[i][8]+sin(xim_m[i][1]*2.0)*xim_m[i][8]*2.3E1+sin(xim_m[i][2]*2.0)*xim_m[i][8]*2.0-cos(xim_m[i][0]*2.0+xim_m[i][1]*2.0)*xim_m[i][9]-cos(xim_m[i][1]*2.0+xim_m[i][2]*2.0)*xim_m[i][9]*2.0-sin(xim_m[i][0]*2.0+xim_m[i][1]*2.0)*xim_m[i][8]-sin(xim_m[i][1]*2.0+xim_m[i][2]*2.0)*xim_m[i][8]*2.0+xim_m[i][9]*2.3E1)*2.0)*xim_m[i][7])/(sin(xim_m[i][0])*xim_m[i][5]-sin(xim_m[i][1])*xim_m[i][6]);
	  PI_map(9,2) = -(cos(xim_m[i][2]*2.0)*xim_m[i][8]*2.0-sin(xim_m[i][2]*2.0)*xim_m[i][9]*2.0-cos(xim_m[i][1]*2.0+xim_m[i][2]*2.0)*xim_m[i][8]*2.0+sin(xim_m[i][1]*2.0+xim_m[i][2]*2.0)*xim_m[i][9]*2.0)/(cos(xim_m[i][0]*2.0+xim_m[i][1]*2.0)+cos(xim_m[i][1]*2.0+xim_m[i][2]*2.0)*2.0-2.3E1)-sin(xim_m[i][1]*2.0+xim_m[i][2]*2.0)*1.0/pow(cos(xim_m[i][0]*2.0+xim_m[i][1]*2.0)+cos(xim_m[i][1]*2.0+xim_m[i][2]*2.0)*2.0-2.3E1,2.0)*(cos(xim_m[i][0]*2.0)*xim_m[i][9]-cos(xim_m[i][1]*2.0)*xim_m[i][9]*2.3E1+cos(xim_m[i][2]*2.0)*xim_m[i][9]*2.0+sin(xim_m[i][0]*2.0)*xim_m[i][8]+sin(xim_m[i][1]*2.0)*xim_m[i][8]*2.3E1+sin(xim_m[i][2]*2.0)*xim_m[i][8]*2.0-cos(xim_m[i][0]*2.0+xim_m[i][1]*2.0)*xim_m[i][9]-cos(xim_m[i][1]*2.0+xim_m[i][2]*2.0)*xim_m[i][9]*2.0-sin(xim_m[i][0]*2.0+xim_m[i][1]*2.0)*xim_m[i][8]-sin(xim_m[i][1]*2.0+xim_m[i][2]*2.0)*xim_m[i][8]*2.0+xim_m[i][9]*2.3E1)*2.0;
	  PI_map(9,4) = -(((cos(xim_m[i][1]*2.0)*xim_m[i][8]*2.3E1+sin(xim_m[i][1]*2.0)*xim_m[i][9]*2.3E1-cos(xim_m[i][0]*2.0+xim_m[i][1]*2.0)*xim_m[i][8]-cos(xim_m[i][1]*2.0+xim_m[i][2]*2.0)*xim_m[i][8]*2.0+sin(xim_m[i][0]*2.0+xim_m[i][1]*2.0)*xim_m[i][9]+sin(xim_m[i][1]*2.0+xim_m[i][2]*2.0)*xim_m[i][9]*2.0)/(cos(xim_m[i][0]*2.0+xim_m[i][1]*2.0)+cos(xim_m[i][1]*2.0+xim_m[i][2]*2.0)*2.0-2.3E1)+(sin(xim_m[i][0]*2.0+xim_m[i][1]*2.0)*4.0+sin(xim_m[i][1]*2.0+xim_m[i][2]*2.0)*8.0)*1.0/pow(cos(xim_m[i][0]*2.0+xim_m[i][1]*2.0)+cos(xim_m[i][1]*2.0+xim_m[i][2]*2.0)*2.0-2.3E1,2.0)*(cos(xim_m[i][0]*2.0)*xim_m[i][9]-cos(xim_m[i][1]*2.0)*xim_m[i][9]*2.3E1+cos(xim_m[i][2]*2.0)*xim_m[i][9]*2.0+sin(xim_m[i][0]*2.0)*xim_m[i][8]+sin(xim_m[i][1]*2.0)*xim_m[i][8]*2.3E1+sin(xim_m[i][2]*2.0)*xim_m[i][8]*2.0-cos(xim_m[i][0]*2.0+xim_m[i][1]*2.0)*xim_m[i][9]-cos(xim_m[i][1]*2.0+xim_m[i][2]*2.0)*xim_m[i][9]*2.0-sin(xim_m[i][0]*2.0+xim_m[i][1]*2.0)*xim_m[i][8]-sin(xim_m[i][1]*2.0+xim_m[i][2]*2.0)*xim_m[i][8]*2.0+xim_m[i][9]*2.3E1)*(1.0/4.0))*xim_m[i][6])/(sin(xim_m[i][0])*xim_m[i][5]-sin(xim_m[i][1])*xim_m[i][6])-(((cos(xim_m[i][0]*2.0)*xim_m[i][8]-sin(xim_m[i][0]*2.0)*xim_m[i][9]-cos(xim_m[i][0]*2.0+xim_m[i][1]*2.0)*xim_m[i][8]+sin(xim_m[i][0]*2.0+xim_m[i][1]*2.0)*xim_m[i][9])/(cos(xim_m[i][0]*2.0+xim_m[i][1]*2.0)+cos(xim_m[i][1]*2.0+xim_m[i][2]*2.0)*2.0-2.3E1)+sin(xim_m[i][0]*2.0+xim_m[i][1]*2.0)*1.0/pow(cos(xim_m[i][0]*2.0+xim_m[i][1]*2.0)+cos(xim_m[i][1]*2.0+xim_m[i][2]*2.0)*2.0-2.3E1,2.0)*(cos(xim_m[i][0]*2.0)*xim_m[i][9]-cos(xim_m[i][1]*2.0)*xim_m[i][9]*2.3E1+cos(xim_m[i][2]*2.0)*xim_m[i][9]*2.0+sin(xim_m[i][0]*2.0)*xim_m[i][8]+sin(xim_m[i][1]*2.0)*xim_m[i][8]*2.3E1+sin(xim_m[i][2]*2.0)*xim_m[i][8]*2.0-cos(xim_m[i][0]*2.0+xim_m[i][1]*2.0)*xim_m[i][9]-cos(xim_m[i][1]*2.0+xim_m[i][2]*2.0)*xim_m[i][9]*2.0-sin(xim_m[i][0]*2.0+xim_m[i][1]*2.0)*xim_m[i][8]-sin(xim_m[i][1]*2.0+xim_m[i][2]*2.0)*xim_m[i][8]*2.0+xim_m[i][9]*2.3E1))*xim_m[i][5])/(sin(xim_m[i][0])*xim_m[i][5]-sin(xim_m[i][1])*xim_m[i][6])-(((cos(xim_m[i][2]*2.0)*xim_m[i][8]*2.0-sin(xim_m[i][2]*2.0)*xim_m[i][9]*2.0-cos(xim_m[i][1]*2.0+xim_m[i][2]*2.0)*xim_m[i][8]*2.0+sin(xim_m[i][1]*2.0+xim_m[i][2]*2.0)*xim_m[i][9]*2.0)/(cos(xim_m[i][0]*2.0+xim_m[i][1]*2.0)+cos(xim_m[i][1]*2.0+xim_m[i][2]*2.0)*2.0-2.3E1)+sin(xim_m[i][1]*2.0+xim_m[i][2]*2.0)*1.0/pow(cos(xim_m[i][0]*2.0+xim_m[i][1]*2.0)+cos(xim_m[i][1]*2.0+xim_m[i][2]*2.0)*2.0-2.3E1,2.0)*(cos(xim_m[i][0]*2.0)*xim_m[i][9]-cos(xim_m[i][1]*2.0)*xim_m[i][9]*2.3E1+cos(xim_m[i][2]*2.0)*xim_m[i][9]*2.0+sin(xim_m[i][0]*2.0)*xim_m[i][8]+sin(xim_m[i][1]*2.0)*xim_m[i][8]*2.3E1+sin(xim_m[i][2]*2.0)*xim_m[i][8]*2.0-cos(xim_m[i][0]*2.0+xim_m[i][1]*2.0)*xim_m[i][9]-cos(xim_m[i][1]*2.0+xim_m[i][2]*2.0)*xim_m[i][9]*2.0-sin(xim_m[i][0]*2.0+xim_m[i][1]*2.0)*xim_m[i][8]-sin(xim_m[i][1]*2.0+xim_m[i][2]*2.0)*xim_m[i][8]*2.0+xim_m[i][9]*2.3E1)*2.0)*xim_m[i][7])/(sin(xim_m[i][0])*xim_m[i][5]-sin(xim_m[i][1])*xim_m[i][6]);
	  PI_map(9,8) = -(-sin(xim_m[i][0]*2.0+xim_m[i][1]*2.0)-sin(xim_m[i][1]*2.0+xim_m[i][2]*2.0)*2.0+sin(xim_m[i][0]*2.0)+sin(xim_m[i][1]*2.0)*2.3E1+sin(xim_m[i][2]*2.0)*2.0)/(cos(xim_m[i][0]*2.0+xim_m[i][1]*2.0)*2.0+cos(xim_m[i][1]*2.0+xim_m[i][2]*2.0)*4.0-4.6E1);
	  PI_map(9,9) = (cos(xim_m[i][0]*2.0+xim_m[i][1]*2.0)+cos(xim_m[i][1]*2.0+xim_m[i][2]*2.0)*2.0-cos(xim_m[i][0]*2.0)+cos(xim_m[i][1]*2.0)*2.3E1-cos(xim_m[i][2]*2.0)*2.0-2.3E1)/(cos(xim_m[i][0]*2.0+xim_m[i][1]*2.0)*2.0+cos(xim_m[i][1]*2.0+xim_m[i][2]*2.0)*4.0-4.6E1);

		
		
		State2Mat( rho, mrho_ );   // convert state to matrix form
		mrho_ = PI_map.transpose()*mrho_;
		//from matrix to state
		for (indx_ = 0; indx_ < xlen; ++indx_ ) { rho[indx_] = mrho_[indx_]; }
		
	  //Relabel coordinates (swap angles/angular velocities)
	  double temp = rho[1]; rho[1] = -rho[0]; rho[0] = -temp;
	  temp = rho[6]; rho[6] = -rho[5]; rho[5] = -temp;
	}
  
    /* Function that calculates impact point x_imp with simulations*/
	void impacts::calc_imp_point (sys_dynam& xdot, std::vector<state_type> &x_vec, state_type &times){
		using namespace boost::numeric::odeint;		
		typedef runge_kutta_dopri5< state_type > stepper_type;
		size_t steps;
		len = times.size();
		taf = times[len-1]; 
		tbef = times[len-2]; tb=tbef; 
		
		//std::cout << "time before/after impact: "<< tb << " " << taf << '\n';
		
		//Find impact point with consecutive simulations
		
		x_imp = x_vec[len-2];		
		while(std::abs(taf - tb) > 1E-4) {  
			t_m = 0.5 * (tb + taf);  // get the mid point time	
			xtemp = x_imp;//store this value
			steps = integrate_adaptive( 
						  make_controlled( 1E-4 , 1E-4 , 
								   stepper_type( ) ) , 
						  xdot , x_imp , tb , t_m , 0.0005 );

			if (condition(x_imp, x_vec[len-2])){
				taf = t_m;  // condition changer lies before midpoint
				x_imp = xtemp;//restore initial condition
			}
			else {            
				tb = t_m;  // condition changer lies after midpoint
			}
		}
		
		// we found the interval of size eps, take it's midpoint as final guess
		t_m = 0.5 * (tb + taf);
		x_imp = x_vec[len-2];//restore initial condition
		integrate_adaptive( 
						  make_controlled( 1E-4 , 1E-4 , 
								   stepper_type( ) ) , 
						  xdot , x_imp , tbef , t_m , 0.0005 );
		
		
		
		/*double xtoe1 = x_imp[3] - sin(x_imp[0]), xtoe2 = x_imp[3] + sin(x_imp[1]);
		double ztoe2_prev = x_vec[len-2][4]-cos(x_vec[len-2][1]) - Grnd(x_vec[len-2]);
		std::cout << "impact point: "<< t_m << "  "<<times[len-1] << '\n';
				
		double ztoe2 = x_imp[4]-cos(x_imp[1]) - Grnd(x_imp);
		double Dztoe2 = x_imp[9]+sin(x_imp[1])*x_imp[6] - DGrnd(x_imp);//derivative of above
		std::cout << xtoe1 << " " << xtoe2 << " " << ztoe2 << " " <<ztoe2_prev<< "\n";
			system("PAUSE");*/
		
		
		
		
		/*Update xHdot and zHdot before impact in STANCE mode (can't use x_imp[8] and x_imp[9])
		since those are based on integration using the dummy f[8] and f[9] from dynamics. In flight
		mode we don't have this problem so we have to check first whether we were in stance or flight mode.
		The update is basically the derivative of forward kinematics of stance mode*/
		
		//if xHdot (x_imp[8]) < flight_threshold.  {//if we are in stance mode
			x_imp[8] = x_imp[5]*cos(x_imp[0]);// th1dot_minus*cos(th1);
			x_imp[9] = -x_imp[5]*sin(x_imp[0]);//-th1dot_minus*sin(th1);

		//}
		

		times.pop_back(); x_vec.pop_back();
		
		//Store those for reset map of adjoint
		xim_m.push_back( x_imp );
		imp_times.push_back( t_m );
		
		//Append to state - this is t-!!
		x_vec.push_back( x_imp );
		times.push_back( t_m );
		
		//Solve impact equations here
		//x_imp[1]=-x_imp[1];
		Omega (x_imp, x_imp);
		t_m = t_m + impact_duration;//this is t+
		
		//Append to state - this is t+
		x_vec.push_back( x_imp );
		times.push_back( t_m );	

		//Store those for reset map of adjoint
		xim_p.push_back( x_imp );		
		
		/*Store first impact point for plotting*/
		if(t_m < impacts::tm) {impacts::ximp = x_imp; impacts::tm = t_m;}
	
	}

}

#endif  // IMPACTS_HPP
